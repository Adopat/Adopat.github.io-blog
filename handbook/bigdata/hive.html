<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第七章 HIVE | Adopat的博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/blog/logo.jpeg">
    <link rel="manifest" href="/blog/logo.jpeg">
    <link rel="apple-touch-icon" href="/blog/logo.jpeg">
    <link rel="mask-icon" href="/blog/logo.jpeg" color="#3eaf7c">
    <meta name="description" content="长路漫漫，唯键作伴">
    <meta http-quiv="pragma" cotent="no-cache">
    <meta http-quiv="expires" cotent="0">
    <meta http-quiv="pragma" cotent="no-cache, must-revalidate">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta charset="utf-8">
    
    <link rel="preload" href="/blog/assets/css/0.styles.c74f429a.css" as="style"><link rel="preload" href="/blog/assets/js/app.f600c34c.js" as="script"><link rel="preload" href="/blog/assets/js/3.1aae9359.js" as="script"><link rel="preload" href="/blog/assets/js/1.ae8a88ec.js" as="script"><link rel="preload" href="/blog/assets/js/45.96aaada5.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.d3b9c11d.js"><link rel="prefetch" href="/blog/assets/js/11.acb152df.js"><link rel="prefetch" href="/blog/assets/js/12.c8509742.js"><link rel="prefetch" href="/blog/assets/js/13.811061e2.js"><link rel="prefetch" href="/blog/assets/js/14.db6b0e70.js"><link rel="prefetch" href="/blog/assets/js/15.2ce37a4a.js"><link rel="prefetch" href="/blog/assets/js/16.b3452aec.js"><link rel="prefetch" href="/blog/assets/js/17.dc1a8405.js"><link rel="prefetch" href="/blog/assets/js/18.f03199ab.js"><link rel="prefetch" href="/blog/assets/js/19.bb1e396b.js"><link rel="prefetch" href="/blog/assets/js/20.4e2d0adb.js"><link rel="prefetch" href="/blog/assets/js/21.b67291e2.js"><link rel="prefetch" href="/blog/assets/js/22.057ea7c4.js"><link rel="prefetch" href="/blog/assets/js/23.70da62c2.js"><link rel="prefetch" href="/blog/assets/js/24.8cd404c5.js"><link rel="prefetch" href="/blog/assets/js/25.e637bb66.js"><link rel="prefetch" href="/blog/assets/js/26.bb3896ad.js"><link rel="prefetch" href="/blog/assets/js/27.021e6dc3.js"><link rel="prefetch" href="/blog/assets/js/28.6949fbc1.js"><link rel="prefetch" href="/blog/assets/js/29.6c652456.js"><link rel="prefetch" href="/blog/assets/js/30.f23dfdea.js"><link rel="prefetch" href="/blog/assets/js/31.3dcf5164.js"><link rel="prefetch" href="/blog/assets/js/32.b554bb64.js"><link rel="prefetch" href="/blog/assets/js/33.6ba9e186.js"><link rel="prefetch" href="/blog/assets/js/34.2ae1eb6a.js"><link rel="prefetch" href="/blog/assets/js/35.1fe5b5a2.js"><link rel="prefetch" href="/blog/assets/js/36.614599d6.js"><link rel="prefetch" href="/blog/assets/js/37.311ebd2c.js"><link rel="prefetch" href="/blog/assets/js/38.50bccc51.js"><link rel="prefetch" href="/blog/assets/js/39.fc5b9233.js"><link rel="prefetch" href="/blog/assets/js/4.1dd123be.js"><link rel="prefetch" href="/blog/assets/js/40.f5520796.js"><link rel="prefetch" href="/blog/assets/js/41.a23e6477.js"><link rel="prefetch" href="/blog/assets/js/42.1ad13e0e.js"><link rel="prefetch" href="/blog/assets/js/43.1235eb55.js"><link rel="prefetch" href="/blog/assets/js/44.e50bce95.js"><link rel="prefetch" href="/blog/assets/js/46.f656cba5.js"><link rel="prefetch" href="/blog/assets/js/47.e170369f.js"><link rel="prefetch" href="/blog/assets/js/48.95e08a63.js"><link rel="prefetch" href="/blog/assets/js/49.eaea0707.js"><link rel="prefetch" href="/blog/assets/js/5.4cb445b4.js"><link rel="prefetch" href="/blog/assets/js/50.b1126e4d.js"><link rel="prefetch" href="/blog/assets/js/51.c28c85ff.js"><link rel="prefetch" href="/blog/assets/js/52.431357ea.js"><link rel="prefetch" href="/blog/assets/js/53.be380102.js"><link rel="prefetch" href="/blog/assets/js/54.5877a497.js"><link rel="prefetch" href="/blog/assets/js/55.e1d5dddb.js"><link rel="prefetch" href="/blog/assets/js/56.1962bc1e.js"><link rel="prefetch" href="/blog/assets/js/57.b7d9dbdd.js"><link rel="prefetch" href="/blog/assets/js/58.b5d9b427.js"><link rel="prefetch" href="/blog/assets/js/59.e07757a4.js"><link rel="prefetch" href="/blog/assets/js/6.e02ce0fc.js"><link rel="prefetch" href="/blog/assets/js/60.50d5d207.js"><link rel="prefetch" href="/blog/assets/js/61.2bdc68d5.js"><link rel="prefetch" href="/blog/assets/js/62.6f6c77db.js"><link rel="prefetch" href="/blog/assets/js/63.fd62d822.js"><link rel="prefetch" href="/blog/assets/js/64.d83a9500.js"><link rel="prefetch" href="/blog/assets/js/65.e76b3053.js"><link rel="prefetch" href="/blog/assets/js/66.de39f9b4.js"><link rel="prefetch" href="/blog/assets/js/67.44ce2347.js"><link rel="prefetch" href="/blog/assets/js/68.9efe46cd.js"><link rel="prefetch" href="/blog/assets/js/69.a06475fc.js"><link rel="prefetch" href="/blog/assets/js/7.3df43e48.js"><link rel="prefetch" href="/blog/assets/js/70.d38d05d7.js"><link rel="prefetch" href="/blog/assets/js/71.563b0c4a.js"><link rel="prefetch" href="/blog/assets/js/72.14bc1390.js"><link rel="prefetch" href="/blog/assets/js/73.9d176c78.js"><link rel="prefetch" href="/blog/assets/js/74.3a37688f.js"><link rel="prefetch" href="/blog/assets/js/75.7c4802f6.js"><link rel="prefetch" href="/blog/assets/js/76.7309aafa.js"><link rel="prefetch" href="/blog/assets/js/77.418b1686.js"><link rel="prefetch" href="/blog/assets/js/78.8b748ecf.js"><link rel="prefetch" href="/blog/assets/js/8.417a4fef.js"><link rel="prefetch" href="/blog/assets/js/9.28024d7d.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.c74f429a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1c636796><div data-v-1c636796><div class="password-shadow password-wrapper-out" style="display:none;" data-v-2c3e9f55 data-v-1c636796 data-v-1c636796><h3 class="title" data-v-2c3e9f55>Adopat的博客</h3> <p class="description" data-v-2c3e9f55>长路漫漫，唯键作伴</p> <label id="box" class="inputBox" data-v-2c3e9f55><input type="password" value="" data-v-2c3e9f55> <span data-v-2c3e9f55>Konck! Knock!</span> <button data-v-2c3e9f55>OK</button></label> <div class="footer" data-v-2c3e9f55><span data-v-2c3e9f55><i class="iconfont reco-theme" data-v-2c3e9f55></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-2c3e9f55>vuePress-theme-reco</a></span> <span data-v-2c3e9f55><i class="iconfont reco-copyright" data-v-2c3e9f55></i> <a data-v-2c3e9f55><span data-v-2c3e9f55>Adopat</span>
          
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-1c636796><header class="navbar" data-v-1c636796><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.jpeg" alt="Adopat的博客" class="logo"> <span class="site-name">Adopat的博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  HOME
</a></div><div class="nav-item"><a href="/blog/handbook/about/" class="nav-link"><i class="iconfont reco-document"></i>
  导读
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/handbook/basic/composition-principle.html" class="nav-link"><i class="fa fa-solid fa-computer"></i>
  计算机基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/frontend/basic.html" class="nav-link"><i class="fa fa-brands fa-js"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/backend/java-core-basic.html" class="nav-link"><i class="fa fa-brands fa-java"></i>
  后端
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/database/" class="nav-link"><i class="fa fa-solid fa-database"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/bigdata/hadoop.html" class="nav-link"><i class="fa fa-brands fa-hive"></i>
  大数据
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/ml/python-core.html" class="nav-link"><i class="fa fa-brands fa-python"></i>
  人工智能
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/devops/docker.html" class="nav-link"><i class="fa fa-brands fa-docker"></i>
  运维
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/tools/Git.html" class="nav-link"><i class="fa fa-solid fa-toolbox"></i>
  常用开发工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      友情链接
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/weixin_44446122?type=blog" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-csdn"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Adopat" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1c636796></div> <aside class="sidebar" data-v-1c636796><div class="personal-info-wrapper" data-v-6f92ba70 data-v-1c636796><!----> <h3 class="name" data-v-6f92ba70>
    Adopat
  </h3> <div class="num" data-v-6f92ba70><div data-v-6f92ba70><h3 data-v-6f92ba70>67</h3> <h6 data-v-6f92ba70>文章</h6></div> <div data-v-6f92ba70><h3 data-v-6f92ba70>0</h3> <h6 data-v-6f92ba70>标签</h6></div></div> <ul class="social-links" data-v-6f92ba70></ul> <hr data-v-6f92ba70></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  HOME
</a></div><div class="nav-item"><a href="/blog/handbook/about/" class="nav-link"><i class="iconfont reco-document"></i>
  导读
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/handbook/basic/composition-principle.html" class="nav-link"><i class="fa fa-solid fa-computer"></i>
  计算机基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/frontend/basic.html" class="nav-link"><i class="fa fa-brands fa-js"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/backend/java-core-basic.html" class="nav-link"><i class="fa fa-brands fa-java"></i>
  后端
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/database/" class="nav-link"><i class="fa fa-solid fa-database"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/bigdata/hadoop.html" class="nav-link"><i class="fa fa-brands fa-hive"></i>
  大数据
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/ml/python-core.html" class="nav-link"><i class="fa fa-brands fa-python"></i>
  人工智能
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/devops/docker.html" class="nav-link"><i class="fa fa-brands fa-docker"></i>
  运维
</a></li><li class="dropdown-item"><!----> <a href="/blog/handbook/tools/Git.html" class="nav-link"><i class="fa fa-solid fa-toolbox"></i>
  常用开发工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      友情链接
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/weixin_44446122?type=blog" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-csdn"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Adopat" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>大数据基础</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/handbook/bigdata/hadoop.html" class="sidebar-link">第一章 Hadoop</a></li><li><a href="/blog/handbook/bigdata/hdfs.html" class="sidebar-link">第二章 HDFS</a></li><li><a href="/blog/handbook/bigdata/mapreduce.html" class="sidebar-link">第三章 MapReduce</a></li><li><a href="/blog/handbook/bigdata/mapreduce1.html" class="sidebar-link">第四章 MapReduce性能优化</a></li><li><a href="/blog/handbook/bigdata/yarn.html" class="sidebar-link">第五章 YARN</a></li><li><a href="/blog/handbook/bigdata/flume.html" class="sidebar-link">第六章 Flume</a></li><li><a href="/blog/handbook/bigdata/hive.html" aria-current="page" class="active sidebar-link">第七章 HIVE</a></li><li><a href="/blog/handbook/bigdata/scala.html" class="sidebar-link">第八章 Scala</a></li><li><a href="/blog/handbook/bigdata/spark.html" class="sidebar-link">第九章 Spark</a></li><li><a href="/blog/handbook/bigdata/flink.html" class="sidebar-link">第十章 Flink</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>大数据进阶</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-2c3e9f55 data-v-1c636796><h3 class="title" data-v-2c3e9f55></h3> <!----> <label id="box" class="inputBox" data-v-2c3e9f55><input type="password" value="" data-v-2c3e9f55> <span data-v-2c3e9f55>Konck! Knock!</span> <button data-v-2c3e9f55>OK</button></label> <div class="footer" data-v-2c3e9f55><span data-v-2c3e9f55><i class="iconfont reco-theme" data-v-2c3e9f55></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-2c3e9f55>vuePress-theme-reco</a></span> <span data-v-2c3e9f55><i class="iconfont reco-copyright" data-v-2c3e9f55></i> <a data-v-2c3e9f55><span data-v-2c3e9f55>Adopat</span>
          
        <!---->
        2023
      </a></span></div></div> <div data-v-1c636796><div data-v-1c636796><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">第七章 HIVE</h1> <div data-v-6acedb3b><i class="iconfont reco-account" data-v-6acedb3b><span data-v-6acedb3b>Adopat</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="第七章-hive"><a href="#第七章-hive" class="header-anchor">#</a> 第七章 HIVE</h1> <h2 id="_7-1-hive概念"><a href="#_7-1-hive概念" class="header-anchor">#</a> 7.1  HIVE概念</h2> <p>HIVE是建立在HADOOP上的数据仓库基础架构。HIVE 存储依赖HDFS,计算依赖mapreduce.</p> <blockquote><p>SQL ON HADOOP,mapreduce 是hive的默认执行引擎。</p></blockquote> <h2 id="_7-2-hive-架构和原理"><a href="#_7-2-hive-架构和原理" class="header-anchor">#</a> 7.2  HIVE 架构和原理</h2> <ul><li><p>HIVE 架构</p> <p><img src="/blog/Hadoop%E7%94%9F%E6%80%81%E4%BD%93%E7%B3%BB.assets/image-20220903102933137.png" alt="image-20220903102933137"></p> <blockquote><p>1、用户接口，包括 CLI、JDBC/ODBC、WebGUI
CLI，即Shell命令行，表示我们可以通过shell命令行操作Hive
JDBC/ODBC 是 Hive 的Java操作方式，与使用传统数据库JDBC的方式类似
2、WebUI是通过浏览器访问 Hive
元数据存储(Metastore)，注意：这里的存储是名词，Metastore表示是一个存储系统
Hive中的元数据包括表的相关信息，Hive会将这些元数据存储在Metastore中，目前Metastore只支持 mysql、derby。
3、Driver：包含：编译器、优化器、执行器
编译器、优化器、执行器可以完成 Hive的 查询语句从词法分析、语法分析、编译、优化以及查询计划的生成。生成的查询计划最终存储在 HDFS 中，并在随后由 MapReduce 调用执行
4、Hadoop：Hive会使用 HDFS 进行存储，利用 MapReduce 进行计算
Hive 的数据存储在 HDFS 中，大部分的查询由 MapReduce 完成（特例 select * from table 不会生成 MapRedcue 任务，如果在SQL语句后面再增加where过滤条件就会生成MapReduce任务了。）</p></blockquote></li> <li><p>HIVE 执行流程</p> <p><img src="/blog/Hadoop%E7%94%9F%E6%80%81%E4%BD%93%E7%B3%BB.assets/image-20220903103155649.png" alt="image-20220903103155649"></p></li></ul> <h2 id="_7-3-hive-安装和连接"><a href="#_7-3-hive-安装和连接" class="header-anchor">#</a> 7.3  HIVE 安装和连接</h2> <ul><li><p>安装</p> <ol><li><p>文件下载上传解压</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@bigdata04 soft<span class="token punctuation">]</span><span class="token comment"># ll apache-hive*</span>
-rw-r--r--.  <span class="token number">1</span> root root <span class="token number">278813748</span> Aug <span class="token number">29</span> <span class="token number">11</span>:29 apache-hive-3.1.2-bin.tar.gz
<span class="token punctuation">[</span>root@bigdata04 soft<span class="token punctuation">]</span><span class="token comment"># tar -zxvf apache-hive-3.1.2-bin.tar.gz</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>重命名配置文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@bigdata04 soft]# cd apache-hive-3.1.2-bin/conf/
[root@bigdata04 conf]# mv hive-env.sh.template  hive-env.sh
[root@bigdata04 conf]# mv hive-default.xml.template  hive-site.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>修改文件内容</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1. 修改 hive-env.sh 内容，增加环境变量</span>
<span class="token punctuation">[</span>root@bigdata04 soft<span class="token punctuation">]</span><span class="token comment"># cd apache-hive-3.1.2-bin/conf/</span>
<span class="token punctuation">[</span>root@bigdata04 conf<span class="token punctuation">]</span><span class="token comment"># vi hive-env.sh </span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/data/soft/jdk1.8
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HIVE_HOME</span><span class="token operator">=</span>/data/soft/apache-hive-3.1.2-bin
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_HOME</span><span class="token operator">=</span>/data/soft/hadoop-3.2.0
<span class="token comment"># 修改 hive-site.xml</span>
<span class="token punctuation">[</span>root@bigdata04 conf<span class="token punctuation">]</span><span class="token comment"># vi hive-site.xml</span>
<span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax.jdo.option.ConnectionURL<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>jdbc:mysql://172.18.32.39:3306/hive?serverTimezone<span class="token operator">=</span>Asia/Shanghai<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax.jdo.option.ConnectionDriverName<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>com.mysql.cj.jdbc.Driver<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax.jdo.option.ConnectionUserName<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>root<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax.jdo.option.ConnectionPassword<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>root<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive.querylog.location<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>/data/hive_repo/querylog<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive.exec.local.scratchdir<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>/data/hive_repo/scratchdir<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive.downloaded.resources.dir<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>/data/hive_repo/resources<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive.txn.xlock.iow<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/description<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><blockquote><p>jdbc:mysql://172.18.32.39:3306/hive?serverTimezone=Asia/Shanghai ip 为MYSQL 安装所在机器IP，</p> <p>hive.txn.xlock.iow 中的 description 内容必须删除，不然后期会初始化不成功。</p></blockquote></li> <li><p>安装MySQL8.0</p> <blockquote><p><a href="https://blog.csdn.net/Cherry_King/article/details/121730918" target="_blank" rel="noopener noreferrer">windows 安装 MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/weixin_44436964/article/details/123845958" target="_blank" rel="noopener noreferrer">Centos 安装 MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.freesion.com/article/2236524533/" target="_blank" rel="noopener noreferrer">Centos 安装Oracle 服务<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></li> <li><p>上传MySQL驱动包</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@bigdata04 lib<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/data/soft/apache-hive-3.1.2-bin/lib
<span class="token punctuation">[</span>root@bigdata04 lib<span class="token punctuation">]</span><span class="token comment"># ll mysql*</span>
-rw-r--r--. <span class="token number">1</span> root root <span class="token number">2321813</span> Aug  <span class="token number">9</span>  <span class="token number">2021</span> mysql-connector-java-8.0.17.jar
-rw-r--r--. <span class="token number">1</span> root root   <span class="token number">10476</span> Nov <span class="token number">16</span>  <span class="token number">2018</span> mysql-metadata-storage-0.12.0.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>修改core-site.xml</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@bigdata01 hadoop<span class="token punctuation">]</span><span class="token comment"># vi core-site.xml</span>
    <span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hadoop.proxyuser.root.hosts<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>*<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hadoop.proxyuser.root.groups<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>*<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop<span class="token punctuation">]</span><span class="token comment"># scp -rq etc/hadoop/core-site.xml  bigdata02:/data/soft/hadoop-3.2.0/etc/hadoop/</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop<span class="token punctuation">]</span><span class="token comment"># scp -rq etc/hadoop/core-site.xml  bigdata03:/data/soft/hadoop-3.2.0/etc/hadoop/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>配置系统环境变量</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@bigdata04 lib<span class="token punctuation">]</span><span class="token comment"># cat /etc/profile</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/data/soft/jdk1.8
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_HOME</span><span class="token operator">=</span>/data/soft/hadoop-3.2.0
<span class="token builtin class-name">export</span> <span class="token assign-left variable">FLUME_HOME</span><span class="token operator">=</span>/data/soft/apache-flume-1.9.0-bin
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HIVE_HOME</span><span class="token operator">=</span>/data/soft/apache-hive-3.1.2-bin
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>.:<span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$HADOOP_HOME</span>/bin:<span class="token variable">$HADOOP_HOME</span>/bin:<span class="token variable">$FLUME_HOME</span>/bin:<span class="token variable">$HIVE_HOME</span>/bin:<span class="token environment constant">$PATH</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>重新加载环境变量配置文件 生效配置 <code>source /etc/profile</code></p></blockquote></li> <li><p>重启Hadoop集群</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># sbin/stop-all.sh</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># sbin/start-all.sh</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>修改host文件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@bigdata01 ~<span class="token punctuation">]</span><span class="token comment"># vi /etc/hosts</span>
<span class="token number">1192.168</span>.35.100 bigdata01
<span class="token number">192.168</span>.35.101 bigdata02
<span class="token number">192.168</span>.35.102 bigdata03
<span class="token number">192.168</span>.35.103 bigdata04
<span class="token punctuation">[</span>root@bigdata02 ~<span class="token punctuation">]</span><span class="token comment"># vi /etc/hosts</span>
<span class="token number">192.168</span>.35.100 bigdata01
<span class="token number">192.168</span>.35.101 bigdata02
<span class="token number">192.168</span>.35.102 bigdata03
<span class="token number">192.168</span>.35.103 bigdata04
<span class="token punctuation">[</span>root@bigdata03 ~<span class="token punctuation">]</span><span class="token comment"># vi /etc/hosts</span>
<span class="token number">192.168</span>.35.100 bigdata01
<span class="token number">192.168</span>.35.101 bigdata02
<span class="token number">192.168</span>.35.102 bigdata03
<span class="token number">192.168</span>.35.103 bigdata04
<span class="token punctuation">[</span>root@bigdata04 ~<span class="token punctuation">]</span><span class="token comment"># vi /etc/hosts</span>
<span class="token number">192.168</span>.35.100 bigdata01
<span class="token number">192.168</span>.35.101 bigdata02
<span class="token number">192.168</span>.35.102 bigdata03
<span class="token number">192.168</span>.35.103 bigdata04
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li> <li><p>初始化Hive的Metastore</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@bigdata04 apache-hive-3.1.2-bin<span class="token punctuation">]</span><span class="token comment"># bin/schematool -dbType mysql -initSchema</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>记得要先创建 hive 数据库</p></blockquote></li></ol></li> <li><p>连接方式</p> <ul><li><p>hive</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@bigdata04 lib<span class="token punctuation">]</span><span class="token comment"># hive</span>
which: no hbase <span class="token keyword">in</span> <span class="token punctuation">(</span>.:/data/soft/jdk1.8/bin:/data/soft/hadoop-3.2.0/bin:/data/soft/hadoop-3.2.0/bin:/data/soft/apache-flume-1.9.0-bin/bin:/data/soft/apache-hive-3.1.2-bin/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin<span class="token punctuation">)</span>
Hive Session ID <span class="token operator">=</span> 6b6e917f-86a7-48a8-aa2f-c1dec6150021

Logging initialized using configuration <span class="token keyword">in</span> file:/data/soft/apache-hive-3.1.2-bin/conf/hive-log4j2.properties Async: <span class="token boolean">true</span>
Hive Session ID <span class="token operator">=</span> c07e9a61-c4e0-486c-a0a0-d60a797f7798
Hive-on-MR is deprecated <span class="token keyword">in</span> Hive <span class="token number">2</span> and may not be available <span class="token keyword">in</span> the future versions. Consider using a different execution engine <span class="token punctuation">(</span>i.e. spark, tez<span class="token punctuation">)</span> or using Hive <span class="token number">1</span>.X releases.
hive <span class="token punctuation">(</span>default<span class="token punctuation">)</span><span class="token operator">&gt;</span> show databases<span class="token punctuation">;</span>
OK
database_name
default
hive_test
Time taken: <span class="token number">0.566</span> seconds, Fetched: <span class="token number">2</span> row<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
hive <span class="token punctuation">(</span>default<span class="token punctuation">)</span><span class="token operator">&gt;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>beeline</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@bigdata04 lib<span class="token punctuation">]</span><span class="token comment"># hiveserver2</span>
which: no hbase <span class="token keyword">in</span> <span class="token punctuation">(</span>.:/data/soft/jdk1.8/bin:/data/soft/hadoop-3.2.0/bin:/data/soft/hadoop-3.2.0/bin:/data/soft/apache-flume-1.9.0-bin/bin:/data/soft/apache-hive-3.1.2-bin/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin<span class="token punctuation">)</span>
<span class="token number">2022</span>-09-03 <span class="token number">13</span>:36:35: Starting HiveServer2
Hive Session ID <span class="token operator">=</span> 5e9104e0-841c-49b5-8714-fb9090809344
Hive Session ID <span class="token operator">=</span> f7404843-9851-477f-a373-8185f35b9552
Hive Session ID <span class="token operator">=</span> ffe7a1bc-8aca-4519-8ecc-48d973ee613f
Hive Session ID <span class="token operator">=</span> c4a20683-f49e-4dd9-9116-2c5c6facbb17
<span class="token punctuation">[</span>root@bigdata04 ~<span class="token punctuation">]</span><span class="token comment"># beeline -u  jdbc:hive2://192.168.35.103:10000 -n root   </span>
Connecting to jdbc:hive2://192.168.35.103:10000
Connected to: Apache Hive <span class="token punctuation">(</span>version <span class="token number">3.1</span>.2<span class="token punctuation">)</span>
Driver: Hive JDBC <span class="token punctuation">(</span>version <span class="token number">3.1</span>.2<span class="token punctuation">)</span>
Transaction isolation: TRANSACTION_REPEATABLE_READ
Beeline version <span class="token number">3.1</span>.2 by Apache Hive
<span class="token number">0</span>: jdbc:hive2://192.168.35.103:1000<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> show databases<span class="token punctuation">;</span>
+----------------+
<span class="token operator">|</span> database_name  <span class="token operator">|</span>
+----------------+
<span class="token operator">|</span> default        <span class="token operator">|</span>
<span class="token operator">|</span> hive_test      <span class="token operator">|</span>
+----------------+
<span class="token number">2</span> rows selected <span class="token punctuation">(</span><span class="token number">1.367</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span>: jdbc:hive2://192.168.35.103:1000<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><blockquote><p>注意使用 beeline 连接要先开启hiveserver2服务，然后新建窗口连接，</p> <p>注意了，hive后面可以使用 -e 命令，这样这条hive命令就可以放到脚本中定时调度执行了</p></blockquote></li> <li><p>jdbc 连接(第三方工具连接)</p> <p>推荐使用DataGrap 或者DBever连接(注意要开启hiveserver2服务)</p> <p><img src="/blog/Hadoop%E7%94%9F%E6%80%81%E4%BD%93%E7%B3%BB.assets/image-20220903134257759.png" alt="image-20220903134257759"></p></li></ul></li> <li><p>常用设置</p> <ul><li><p>设置显示数据库名和表名</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@bigdata04 apache-hive-3.1.2-bin<span class="token punctuation">]</span><span class="token comment"># vi ~/.hiverc</span>
<span class="token builtin class-name">set</span> hive.cli.print.current.db <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token builtin class-name">set</span> hive.cli.print.header <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>修改~/.hiverc，我们每次在进入hive命令行的时候都会加载当前用户目录下的.hiverc文件中的内容</p></blockquote></li> <li><p>去掉重复打印的日志</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /data/soft/apache-hive-3.1.2-bin/lib
<span class="token function">mv</span> log4j-slf4j-impl-2.10.0.jar  log4j-slf4j-impl-2.10.0.jar.bak
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>hive 日志包 /data/soft/apache-hive-3.1.2-bin/lib/log4j-slf4j-impl-2.10.0.jar</p> <p>hadoop 日志包 /data/soft/hadoop-3.2.0/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar</p> <p>两个日志包冲突，修改 hive 日志包</p></blockquote></li> <li><p>配置hive 的日志输出</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 修改hive-log4j.properties.template 文件</span>
<span class="token builtin class-name">cd</span> <span class="token builtin class-name">cd</span> /data/soft/apache-hive-3.1.2-bin/conf

<span class="token function">mv</span> hive-log4j2.properties.template  hive-log4j2.properties

<span class="token function">vi</span> hive-log4j2.properties

修改如下配置为：
property.hive.log.level <span class="token operator">=</span> WARN
property.hive.root.logger <span class="token operator">=</span> DRFA
property.hive.log.dir <span class="token operator">=</span> /data/hive_repo/log
property.hive.log.file <span class="token operator">=</span> hive.log
property.hive.perflogger.log.level <span class="token operator">=</span> INFO
<span class="token comment"># 修改hive-exec-log4j2.properties.template文件</span>
<span class="token function">mv</span> hive-exec-log4j2.properties.template hive-exec-log4j2.properties

<span class="token function">vi</span> hive-exec-log4j2.properties

修改如下配置为：
property.hive.log.level <span class="token operator">=</span> WARN
property.hive.root.logger <span class="token operator">=</span> FA
property.hive.query.id <span class="token operator">=</span> hadoop
property.hive.log.dir <span class="token operator">=</span> /data/hive_repo/log
property.hive.log.file <span class="token operator">=</span> <span class="token variable">${sys<span class="token operator">:</span>hive.query.id}</span>.log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div></li> <li><p>配置伪表 dual</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token string">'X'</span><span class="token operator">&gt;</span>dual.txt
create table dual <span class="token punctuation">(</span>dummy String<span class="token punctuation">)</span><span class="token punctuation">;</span>
load data <span class="token builtin class-name">local</span> inpath <span class="token string">'/data/soft/hivedata/dual.txt'</span>  into table hive_test.dual<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>配置字段comment</p> <p>可能会出现字段comment 乱码</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> COLUMNS_V2 <span class="token keyword">modify</span> <span class="token keyword">column</span> <span class="token keyword">COMMENT</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> TABLE_PARAMS <span class="token keyword">modify</span> <span class="token keyword">column</span> PARAM_VALUE <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>
<span class="token comment">-- 分区表额外执行以下两条命令</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> PARTITION_PARAMS <span class="token keyword">modify</span> <span class="token keyword">column</span> PARAM_VALUE <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> PARTITION_KEYS <span class="token keyword">modify</span> <span class="token keyword">column</span> PKEY_COMMENT <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li> <li><p>Metastore 常用的表</p> <ul><li><p>常用表</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">--查询表信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">from</span> tbls <span class="token keyword">where</span> TBL_NAME <span class="token operator">=</span> <span class="token string">'t2'</span>
<span class="token comment">--查询数据的输入输出格式、存储位置等信息</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> tbls t<span class="token punctuation">,</span>sds s <span class="token keyword">where</span> t<span class="token punctuation">.</span>SD_ID<span class="token operator">=</span>s<span class="token punctuation">.</span>SD_ID <span class="token operator">and</span> t<span class="token punctuation">.</span>TBL_NAME <span class="token operator">=</span> <span class="token string">'t2'</span>
<span class="token comment">--查询表的属性信息</span>
<span class="token keyword">select</span> p<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> tbls t<span class="token punctuation">,</span>table_params p <span class="token keyword">where</span> t<span class="token punctuation">.</span>TBL_ID<span class="token operator">=</span>p<span class="token punctuation">.</span>TBL_ID <span class="token operator">and</span> t<span class="token punctuation">.</span>TBL_NAME <span class="token operator">=</span> <span class="token string">'t2'</span>
<span class="token comment">--查询表的分区列</span>
<span class="token keyword">select</span> p<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> tbls t<span class="token punctuation">,</span>partition_keys p <span class="token keyword">where</span> t<span class="token punctuation">.</span>TBL_ID<span class="token operator">=</span>p<span class="token punctuation">.</span>TBL_ID <span class="token operator">and</span> t<span class="token punctuation">.</span>TBL_NAME <span class="token operator">=</span> <span class="token string">'t2'</span>
<span class="token comment">-- 存储hive 字段信息 </span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> hive<span class="token punctuation">.</span>columns_v2
<span class="token comment">-- 存储Hive表，视图和索引表相关信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> hive<span class="token punctuation">.</span>tbls t 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p><a href="https://blog.csdn.net/m0_54252387/article/details/125756999" target="_blank" rel="noopener noreferrer">Hive MetaStore 3.1.x 元数据管理库表结构介绍及特色功能<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></li></ul></li></ul> <h2 id="_7-4-hive基础操作"><a href="#_7-4-hive基础操作" class="header-anchor">#</a> 7.4  HIVE基础操作</h2> <ul><li><p>建表语法</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>create table t3_new<span class="token punctuation">(</span>
<span class="token function">id</span> int comment <span class="token string">'ID'</span>,
stu_name string comment <span class="token string">'name'</span>,
stu_birthday <span class="token function">date</span> comment <span class="token string">'birthday'</span>,
online boolean comment <span class="token string">'is online'</span>
<span class="token punctuation">)</span>row <span class="token function">format</span> delimited 
fields terminated by <span class="token string">'\t'</span> 
lines terminated by <span class="token string">'\n'</span><span class="token punctuation">;</span>
<span class="token comment"># 过滤掉文件第一行</span>
create table tableName<span class="token punctuation">(</span>字段名称 字段类型，字段名称 字段类型， <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">)</span>
row <span class="token function">format</span> delimited fields terminated by <span class="token string">','</span>--逗号分隔
tblproperties<span class="token punctuation">(</span><span class="token string">&quot;skip.header.line.count&quot;</span><span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span>  --跳过文件行第一1行
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li></ul> <blockquote><p>row format delimited fields terminated by '\t'  指定列分割符</p> <p>lines terminated by '\n' 指定行分割符，可以默认不写</p></blockquote> <ul><li><p>LOAD语法</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 加载到内部表</span>
LOAD DATA LOCAL INPATH <span class="token string">&quot;/home/hadoopUser/data/test1.txt&quot;</span> INTO TABLE test1<span class="token punctuation">;</span>  
<span class="token comment"># 加载到分区表</span>
load data <span class="token builtin class-name">local</span> inpath <span class="token string">'/liguodong/dataext'</span> into table test1 partition<span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">'20150717'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 覆盖重写数据</span>
load data <span class="token builtin class-name">local</span> inpath <span class="token string">'/data/soft/hivedata/row_number_demo.data'</span> overwrite into table hive_test.row_number_demo<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>local 指的是本地hive安装环境</p> <p>into 代表追加数据，如果需要覆盖重写使用 overwrite into</p></blockquote></li></ul> <h2 id="_7-5-hive进阶"><a href="#_7-5-hive进阶" class="header-anchor">#</a> 7.5 HIVE进阶</h2> <h3 id="_7-5-1-常见的数据类型"><a href="#_7-5-1-常见的数据类型" class="header-anchor">#</a> 7.5.1 常见的数据类型</h3> <ul><li><p>基本数据类型</p> <ul><li>TINYINT</li> <li>SMALLINT</li> <li>INT/INTEGER</li> <li>BIGINT</li> <li>FLOAT</li> <li>DOUBLE</li> <li>DECIMAL</li> <li>TIMESTAMP</li> <li>DATE</li> <li>STRING</li> <li>VARCHAR</li> <li>CHAR</li> <li>BOOLEAN</li></ul></li> <li><p>复合类型</p> <ul><li><p>数组</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 建表语法</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> stu<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name string<span class="token punctuation">,</span>
  favors array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token keyword">row</span> format delimited
<span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\t'</span>
collection items <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
<span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
<span class="token comment">-- 加载数据</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/stu.data'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> stu<span class="token punctuation">;</span>
<span class="token comment">-- stu.data</span>
<span class="token number">1</span>       zhangsan        swing<span class="token punctuation">,</span>sing<span class="token punctuation">,</span>coding
<span class="token number">2</span>       lisi    music<span class="token punctuation">,</span>football
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>map</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 建表语句</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> stu2<span class="token punctuation">(</span>
id <span class="token keyword">int</span><span class="token punctuation">,</span>
name string<span class="token punctuation">,</span>
scores  map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token keyword">row</span> format delimited
<span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\t'</span>
collection items <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
map <span class="token keyword">keys</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">':'</span>
<span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
<span class="token comment">-- 加载数据</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/stu2.data'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> stu2<span class="token punctuation">;</span>
<span class="token comment">-- stu2.data</span>
<span class="token number">1</span>       zhangsan        chinese:<span class="token number">80</span><span class="token punctuation">,</span>math:<span class="token number">90</span><span class="token punctuation">,</span>english:<span class="token number">100</span>
<span class="token number">2</span>       lisi    chinese:<span class="token number">89</span><span class="token punctuation">,</span>english:<span class="token number">70</span><span class="token punctuation">,</span>math:<span class="token number">88</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p>struct</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 建表语句</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> stu3<span class="token punctuation">(</span>
id <span class="token keyword">int</span><span class="token punctuation">,</span>
name string<span class="token punctuation">,</span>
address  struct<span class="token operator">&lt;</span>home_addr:string<span class="token punctuation">,</span>office_addr:string<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token keyword">row</span> format delimited
<span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\t'</span>
collection items <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
<span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
<span class="token comment">-- 加载数据</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/stu3.data'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> stu3<span class="token punctuation">;</span>
<span class="token comment">-- stu3.data</span>
<span class="token number">1</span>       zhangsan        bj<span class="token punctuation">,</span>sh
<span class="token number">2</span>       lisi    gz<span class="token punctuation">,</span>sz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>复合类型综合使用</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 建表语句</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> mix_stu<span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'编码'</span><span class="token punctuation">,</span>
name string <span class="token keyword">comment</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
favors array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span> <span class="token keyword">comment</span> <span class="token string">'爱好'</span><span class="token punctuation">,</span>
scores map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>string<span class="token operator">&gt;</span> <span class="token keyword">comment</span> <span class="token string">'成绩'</span><span class="token punctuation">,</span>
address struct<span class="token operator">&lt;</span>home_addr:string<span class="token punctuation">,</span>office_addr:string<span class="token operator">&gt;</span> <span class="token keyword">comment</span> <span class="token string">'地址'</span>
<span class="token punctuation">)</span><span class="token keyword">row</span> format delimited
<span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\t'</span>
collection items <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
map <span class="token keyword">keys</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">':'</span>
<span class="token comment">-- 加载数据</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/mix_stu.data'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> mix_stu<span class="token punctuation">;</span>
<span class="token comment">-- mix_stu.data</span>
<span class="token number">1</span>       zhangsan        english<span class="token punctuation">,</span>swing<span class="token punctuation">,</span>swing     chinese:<span class="token number">80</span><span class="token punctuation">,</span>math:<span class="token number">90</span><span class="token punctuation">,</span>english:<span class="token number">100</span>  bj<span class="token punctuation">,</span>sh
<span class="token number">2</span>       lisi    games<span class="token punctuation">,</span>coding    chinese:<span class="token number">80</span><span class="token punctuation">,</span>math:<span class="token number">90</span><span class="token punctuation">,</span>english:<span class="token number">100</span>  nj<span class="token punctuation">,</span>sz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li> <li><p>map 和 struct区别</p> <p>map比较灵活，但是会额外占用磁盘空间，因为他比struct多存储了数据的key，struct只需要存储value，比较节省空间，但是灵活性有限，后期无法动态增加k-v。</p></li></ul></li></ul> <h3 id="_7-5-2-hive中的表类型"><a href="#_7-5-2-hive中的表类型" class="header-anchor">#</a> 7.5.2 HIVE中的表类型</h3> <ul><li><p>内部表</p></li> <li><p>外部表</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> external <span class="token keyword">table</span> external_table<span class="token punctuation">(</span>
id <span class="token keyword">int</span><span class="token punctuation">,</span>
name string
<span class="token punctuation">)</span><span class="token keyword">row</span> format delimited
<span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\t'</span>
location <span class="token string">'/data/external'</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> external_table

<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/external_data.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> external_table<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>外部表是最常用的表类型，删除表，并不会删除表中的数据，删除的是对表数据的引用</p></blockquote></li> <li><p>分区表</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 分区表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> partition_1 <span class="token punctuation">(</span>
id <span class="token keyword">int</span><span class="token punctuation">,</span>
name string
<span class="token punctuation">)</span>partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span>dt string<span class="token punctuation">)</span>
<span class="token keyword">row</span> format delimited
<span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\t'</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> partition_1<span class="token punctuation">;</span>

<span class="token comment">-- 展示分区信息</span>
<span class="token keyword">show</span> partitions partition_1<span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/partition_1.data'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1 <span class="token keyword">partition</span><span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">'2022-09-01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/partition_2.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1 <span class="token keyword">partition</span><span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">'2022-09-02'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 给表创建多个分区</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> partition_2<span class="token punctuation">(</span>
id <span class="token keyword">int</span><span class="token punctuation">,</span>
name string
<span class="token punctuation">)</span>partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span><span class="token keyword">year</span> <span class="token keyword">int</span><span class="token punctuation">,</span>school string<span class="token punctuation">)</span>
<span class="token keyword">row</span> format delimited
<span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\t'</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> partition_2<span class="token punctuation">;</span>


<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/partition_3.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2 <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">year</span><span class="token operator">=</span><span class="token number">2020</span><span class="token punctuation">,</span>school<span class="token operator">=</span><span class="token string">'xk'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/partition_3.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2 <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">year</span><span class="token operator">=</span><span class="token number">2021</span><span class="token punctuation">,</span>school<span class="token operator">=</span><span class="token string">'english'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/partition_3.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2 <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">year</span><span class="token operator">=</span><span class="token number">2022</span><span class="token punctuation">,</span>school<span class="token operator">=</span><span class="token string">'math'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/partition_3.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2 <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">year</span><span class="token operator">=</span><span class="token number">2023</span><span class="token punctuation">,</span>school<span class="token operator">=</span><span class="token string">'chinese'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/partition_3.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2 <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">year</span><span class="token operator">=</span><span class="token number">2024</span><span class="token punctuation">,</span>school<span class="token operator">=</span><span class="token string">'xk1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/partition_3.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2 <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">year</span><span class="token operator">=</span><span class="token number">2025</span><span class="token punctuation">,</span>school<span class="token operator">=</span><span class="token string">'xk2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">show</span> partitions partition_2<span class="token punctuation">;</span>

<span class="token comment">-- 外部分区表</span>

<span class="token keyword">create</span> external <span class="token keyword">table</span> ex_par<span class="token punctuation">(</span>
id <span class="token keyword">int</span><span class="token punctuation">,</span>
name string
<span class="token punctuation">)</span>partitioned <span class="token keyword">by</span><span class="token punctuation">(</span>dt string<span class="token punctuation">)</span> 
 <span class="token keyword">row</span> format delimited  
 <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\t'</span>
 location <span class="token string">'/data/ex_par'</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> ex_par<span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/ex_par.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> ex_par <span class="token keyword">partition</span> <span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">'2020-01-01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/ex_par.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> ex_par <span class="token keyword">partition</span> <span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">'2020-01-02'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/ex_par.dat'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> ex_par <span class="token keyword">partition</span> <span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">'2020-01-03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">show</span> partitions ex_par<span class="token punctuation">;</span>

<span class="token comment">-- 删除外部表分区表</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> ex_par <span class="token keyword">drop</span> <span class="token keyword">partition</span><span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">'2020-01-03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 添加分区绑定 </span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> ex_par <span class="token keyword">add</span> <span class="token keyword">partition</span><span class="token punctuation">(</span>dt<span class="token operator">=</span><span class="token string">'2020-01-03'</span><span class="token punctuation">)</span> location <span class="token string">'/data/ex_par/dt=2020-01-03'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div></li> <li><p>桶表</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 桶表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> bucket_tb<span class="token punctuation">(</span>
id <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token keyword">clustered</span> <span class="token keyword">by</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token number">4</span> buckets<span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bucket_tb<span class="token punctuation">;</span>
<span class="token comment">-- 开启桶操作</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span>enforce<span class="token punctuation">.</span>bucketing<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> b_source<span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/data/soft/hivedata/b_source.data'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> b_source<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> b_source<span class="token punctuation">;</span>

<span class="token comment">-- 向桶中加载数据</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">table</span> bucket_tb <span class="token keyword">select</span> id <span class="token keyword">from</span> b_source <span class="token keyword">where</span> id <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bucket_tb<span class="token punctuation">;</span>

<span class="token comment">-- 数据抽样</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bucket_tb tablesample<span class="token punctuation">(</span>bucket <span class="token number">1</span> <span class="token keyword">out</span> <span class="token keyword">of</span> <span class="token number">4</span> <span class="token keyword">on</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bucket_tb tablesample<span class="token punctuation">(</span>bucket <span class="token number">2</span> <span class="token keyword">out</span> <span class="token keyword">of</span> <span class="token number">4</span> <span class="token keyword">on</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bucket_tb tablesample<span class="token punctuation">(</span>bucket <span class="token number">3</span> <span class="token keyword">out</span> <span class="token keyword">of</span> <span class="token number">4</span> <span class="token keyword">on</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bucket_tb tablesample<span class="token punctuation">(</span>bucket <span class="token number">4</span> <span class="token keyword">out</span> <span class="token keyword">of</span> <span class="token number">4</span> <span class="token keyword">on</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li> <li><p>视图</p></li></ul> <h3 id="_7-5-3-hive-函数的使用"><a href="#_7-5-3-hive-函数的使用" class="header-anchor">#</a> 7.5.3 HIVE 函数的使用</h3> <ul><li><p>常用函数</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 1.查看系统自带函数</span>
<span class="token keyword">show</span> functions<span class="token punctuation">;</span>
<span class="token comment">-- 2.显示自带函数的用法</span>
<span class="token keyword">desc</span> <span class="token keyword">function</span> round<span class="token punctuation">;</span>
<span class="token comment">-- 3.显示自带函数的详细用法</span>
<span class="token keyword">desc</span> <span class="token keyword">function</span> <span class="token keyword">extended</span> round<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>时间函数</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 1.unix_timestamp 返回当前或指定时间时间戳</span>
<span class="token keyword">select</span> unix_timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> unix_timestamp<span class="token punctuation">(</span><span class="token string">'2022-09-06'</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 2.from_unixtime 将时间戳转为日期格式</span>
<span class="token keyword">select</span> from_unixtime<span class="token punctuation">(</span><span class="token number">1662422400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 3.current_date 获取当前日期</span>
<span class="token keyword">select</span> <span class="token keyword">current_date</span><span class="token punctuation">;</span>
<span class="token comment">-- 4.current_timestamp 获取当前日期和时间</span>
<span class="token keyword">select</span> <span class="token keyword">current_timestamp</span><span class="token punctuation">;</span>
<span class="token comment">-- 5.to_date 从字符串中提取 时间 to_date()</span>
<span class="token keyword">select</span> to_date<span class="token punctuation">(</span><span class="token string">'2022-09-12 16:00:09'</span><span class="token punctuation">)</span>
<span class="token comment">-- 6.year 获取年</span>
<span class="token keyword">select</span> <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token keyword">current_timestamp</span><span class="token punctuation">)</span>
<span class="token comment">-- 7.month 获取月</span>
<span class="token keyword">select</span> <span class="token keyword">month</span><span class="token punctuation">(</span><span class="token keyword">current_timestamp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 8.获取日</span>
<span class="token keyword">select</span> <span class="token keyword">day</span><span class="token punctuation">(</span><span class="token keyword">current_timestamp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 9.获取小时</span>
<span class="token keyword">select</span> <span class="token keyword">hour</span><span class="token punctuation">(</span><span class="token keyword">current_timestamp</span><span class="token punctuation">)</span>
<span class="token comment">-- 10.获取分钟</span>
<span class="token keyword">select</span> <span class="token keyword">minute</span><span class="token punctuation">(</span><span class="token keyword">current_timestamp</span><span class="token punctuation">)</span>
<span class="token comment">-- 11.获取秒</span>
<span class="token keyword">select</span> <span class="token keyword">second</span><span class="token punctuation">(</span><span class="token keyword">current_timestamp</span><span class="token punctuation">)</span>
<span class="token comment">-- 12.获取周</span>
<span class="token keyword">select</span> weekofyear<span class="token punctuation">(</span><span class="token keyword">current_timestamp</span><span class="token punctuation">)</span>
<span class="token comment">-- 13.获取当前时间是一个月的第几天</span>
<span class="token keyword">select</span> dayofmonth<span class="token punctuation">(</span><span class="token string">'2008-08-08'</span><span class="token punctuation">)</span>
<span class="token comment">-- 14.两个日期相差的月份</span>
<span class="token keyword">select</span> months_between<span class="token punctuation">(</span><span class="token string">'2022-08-08'</span><span class="token punctuation">,</span><span class="token string">'2008-08-08'</span><span class="token punctuation">)</span>
<span class="token comment">-- 15.日期加减月</span>
<span class="token keyword">select</span> add_months<span class="token punctuation">(</span><span class="token string">'2022-09-06'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">-- 16.两个日期相差的天数</span>
<span class="token keyword">select</span> datediff<span class="token punctuation">(</span><span class="token string">'2022-08-08'</span><span class="token punctuation">,</span><span class="token string">'2008-08-08'</span><span class="token punctuation">)</span>
<span class="token comment">-- 17.日期增加天数</span>
<span class="token keyword">select</span> date_add<span class="token punctuation">(</span><span class="token string">'2022-09-06'</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token comment">-- 18.日期减少天数</span>
<span class="token keyword">select</span> date_sub<span class="token punctuation">(</span><span class="token string">'2022-09-06'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token comment">-- 19.日期当月的最后一天</span>
<span class="token keyword">select</span> last_day<span class="token punctuation">(</span><span class="token string">'2022-09-09'</span><span class="token punctuation">)</span>
<span class="token comment">-- 20.字符串转时间</span>
<span class="token keyword">select</span> from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span><span class="token string">'20220909'</span><span class="token punctuation">,</span><span class="token string">'yyyymmdd'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyy-mm-dd'</span><span class="token punctuation">)</span>
<span class="token comment">-- 21.日期格式话</span>
<span class="token keyword">select</span> date_format<span class="token punctuation">(</span><span class="token string">'2022-09-09 18:00:00'</span><span class="token punctuation">,</span><span class="token string">'yyyyMMdd HH:mm:ss'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div></li> <li><p>字符函数</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> upper<span class="token punctuation">(</span><span class="token string">'upper'</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> lower<span class="token punctuation">(</span><span class="token string">'lower'</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> length<span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> trim<span class="token punctuation">(</span><span class="token string">' hello world '</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> LPAD<span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> 
<span class="token keyword">select</span> RPAD<span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> SUBSTR<span class="token punctuation">(</span><span class="token string">'HELLO WORLD'</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> REGEXP_REPLACE<span class="token punctuation">(</span><span class="token string">'2022-09-06'</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">)</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>取整函数</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token number">3.1415</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> ceil<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3.9</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> ceil<span class="token punctuation">(</span><span class="token number">3.1</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> floor<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3.9</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>集合操作</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 1.size 获取数组大小</span>
<span class="token comment">-- 2.map_keys() </span>
<span class="token keyword">select</span> 
size<span class="token punctuation">(</span>favors<span class="token punctuation">)</span><span class="token punctuation">,</span>
map_keys<span class="token punctuation">(</span>scores<span class="token punctuation">)</span><span class="token punctuation">,</span>
map_values<span class="token punctuation">(</span>scores<span class="token punctuation">)</span><span class="token punctuation">,</span>
favors<span class="token punctuation">,</span>
sort_array<span class="token punctuation">(</span>favors<span class="token punctuation">)</span><span class="token comment">-- 只能升序</span>
<span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>mix_stu
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>空值处理</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>nvl<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>条件处理</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">case</span> <span class="token keyword">when</span> 
<span class="token keyword">if</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>行列转换</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 行合并 collect_set()</span>
<span class="token keyword">with</span> temp_b <span class="token keyword">as</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'a'</span> <span class="token keyword">as</span> col <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'b'</span> <span class="token keyword">as</span> col <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'c'</span> <span class="token keyword">as</span> col <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'d'</span> <span class="token keyword">as</span> col <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token number">2</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'e'</span> <span class="token keyword">as</span> col <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token number">2</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'f'</span> <span class="token keyword">as</span> col <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token number">2</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'g'</span> <span class="token keyword">as</span> col <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token number">2</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'h'</span> <span class="token keyword">as</span> col <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token number">2</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'h'</span> <span class="token keyword">as</span> col <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token number">3</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'i'</span> <span class="token keyword">as</span> col <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token punctuation">)</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span>concat_ws<span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">,</span>COLLECT_SET<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> concatcol1 <span class="token keyword">from</span> temp_b <span class="token keyword">group</span> <span class="token keyword">by</span> id
<span class="token comment">-- 列合并 concat() </span>
<span class="token keyword">with</span> temp_c <span class="token keyword">as</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'zhangsan'</span> <span class="token keyword">as</span> name<span class="token punctuation">,</span><span class="token number">10</span> <span class="token keyword">as</span> age <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span> 
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'lisi'</span> <span class="token keyword">as</span> name<span class="token punctuation">,</span><span class="token number">15</span> <span class="token keyword">as</span> age <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span><span class="token string">'wangwu'</span> <span class="token keyword">as</span> name<span class="token punctuation">,</span> <span class="token number">20</span> <span class="token keyword">as</span> age <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token punctuation">)</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>concat<span class="token punctuation">(</span>name<span class="token punctuation">,</span>age<span class="token punctuation">)</span> <span class="token keyword">as</span> name_age<span class="token punctuation">,</span>name<span class="token operator">||</span>age <span class="token keyword">as</span> name_age1 <span class="token keyword">from</span> temp_c 
<span class="token comment">-- 行转列</span>
<span class="token keyword">with</span> temp_d <span class="token keyword">as</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> <span class="token string">'zhangsan'</span> <span class="token keyword">as</span> name <span class="token punctuation">,</span><span class="token string">'chinese'</span> <span class="token keyword">as</span> subject<span class="token punctuation">,</span><span class="token number">90</span> <span class="token keyword">as</span> score <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span> 
<span class="token keyword">select</span> <span class="token string">'zhangsan'</span> <span class="token keyword">as</span> name <span class="token punctuation">,</span><span class="token string">'math'</span> <span class="token keyword">as</span> subject<span class="token punctuation">,</span><span class="token number">87</span> <span class="token keyword">as</span> score <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token string">'zhangsan'</span> <span class="token keyword">as</span> name <span class="token punctuation">,</span><span class="token string">'english'</span> <span class="token keyword">as</span> subject<span class="token punctuation">,</span><span class="token number">75</span> <span class="token keyword">as</span> score <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token string">'lisi'</span> <span class="token keyword">as</span> name <span class="token punctuation">,</span><span class="token string">'chinese'</span> <span class="token keyword">as</span> subject<span class="token punctuation">,</span><span class="token number">70</span> <span class="token keyword">as</span> score <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span> 
<span class="token keyword">select</span> <span class="token string">'lisi'</span> <span class="token keyword">as</span> name <span class="token punctuation">,</span><span class="token string">'math'</span> <span class="token keyword">as</span> subject<span class="token punctuation">,</span><span class="token number">78</span> <span class="token keyword">as</span> score <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token string">'lisi'</span> <span class="token keyword">as</span> name <span class="token punctuation">,</span><span class="token string">'english'</span> <span class="token keyword">as</span> subject<span class="token punctuation">,</span><span class="token number">75</span> <span class="token keyword">as</span> score <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token punctuation">)</span>
<span class="token keyword">select</span> 
name<span class="token punctuation">,</span>
<span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> subject <span class="token operator">=</span><span class="token string">'chinese'</span> <span class="token keyword">then</span> score <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> chinese<span class="token punctuation">,</span>
<span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> subject <span class="token operator">=</span><span class="token string">'math'</span> <span class="token keyword">then</span> score <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> math<span class="token punctuation">,</span>
<span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> subject <span class="token operator">=</span><span class="token string">'english'</span> <span class="token keyword">then</span> score <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> english
<span class="token keyword">from</span> temp_d
<span class="token keyword">group</span> <span class="token keyword">by</span> name

<span class="token comment">-- 列转行</span>
<span class="token keyword">with</span> temp_e <span class="token keyword">as</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> <span class="token string">'lisi'</span> <span class="token keyword">as</span> name<span class="token punctuation">,</span><span class="token number">70</span> <span class="token keyword">as</span> chinese<span class="token punctuation">,</span><span class="token number">78</span> <span class="token keyword">as</span> math<span class="token punctuation">,</span><span class="token number">75</span> <span class="token keyword">as</span> english <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token keyword">union</span> <span class="token keyword">all</span> 
<span class="token keyword">select</span> <span class="token string">'张三'</span> <span class="token keyword">as</span> name<span class="token punctuation">,</span><span class="token number">90</span> <span class="token keyword">as</span> chinese<span class="token punctuation">,</span><span class="token number">87</span> <span class="token keyword">as</span> math<span class="token punctuation">,</span><span class="token number">75</span> <span class="token keyword">as</span> english <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>dual
<span class="token punctuation">)</span>
<span class="token comment">-- 列转行方法一</span>
<span class="token keyword">select</span>
name<span class="token punctuation">,</span>
<span class="token string">'chinese'</span> <span class="token keyword">as</span> subject<span class="token punctuation">,</span>
chinese <span class="token keyword">as</span> score
<span class="token keyword">from</span> temp_e
<span class="token keyword">union</span> <span class="token keyword">all</span> 
<span class="token keyword">select</span>
name<span class="token punctuation">,</span>
<span class="token string">'math'</span> <span class="token keyword">as</span> subject<span class="token punctuation">,</span>
math <span class="token keyword">as</span> score
<span class="token keyword">from</span> temp_e
<span class="token keyword">union</span> <span class="token keyword">all</span> 
<span class="token keyword">select</span>
name<span class="token punctuation">,</span>
<span class="token string">'english'</span> <span class="token keyword">as</span> subject<span class="token punctuation">,</span>
english <span class="token keyword">as</span> score
<span class="token keyword">from</span> temp_e

<span class="token comment">-- 列转行方法二 explode</span>
<span class="token keyword">select</span> t<span class="token punctuation">.</span>name<span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>subject<span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>score <span class="token keyword">from</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> 
name<span class="token punctuation">,</span>
map<span class="token punctuation">(</span><span class="token string">'chinese'</span><span class="token punctuation">,</span>chinese<span class="token punctuation">,</span><span class="token string">'math'</span><span class="token punctuation">,</span>math<span class="token punctuation">,</span><span class="token string">'english'</span><span class="token punctuation">,</span>english<span class="token punctuation">)</span> <span class="token keyword">as</span> score
<span class="token keyword">from</span> temp_e
<span class="token punctuation">)</span> t 
lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>score<span class="token punctuation">)</span> tt2 <span class="token keyword">as</span> subject<span class="token punctuation">,</span>score
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br></div></div></li> <li><p>排序函数</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- row_number() over() 顺序排序</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>subject<span class="token punctuation">,</span>score<span class="token punctuation">,</span>row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> subject <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> rn <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>row_number_demo<span class="token punctuation">;</span>
<span class="token comment">-- rank() over() 跳跃排序</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>subject<span class="token punctuation">,</span>score<span class="token punctuation">,</span>rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> subject <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> rn <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>row_number_demo<span class="token punctuation">;</span>
<span class="token comment">-- dense_rank() over  连续排序</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>subject<span class="token punctuation">,</span>score<span class="token punctuation">,</span>dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> subject <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> rn <span class="token keyword">from</span> hive_test<span class="token punctuation">.</span>row_number_demo<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul> <h3 id="_7-5-4-hive-优化"><a href="#_7-5-4-hive-优化" class="header-anchor">#</a> 7.5.4 HIVE 优化</h3> <ul><li>执行计划</li> <li>抓取</li> <li>合理设置Map及Reduce数</li> <li>并行执行</li> <li>严格模式</li></ul> <blockquote><p><a href="https://blog.csdn.net/qq_37232843/article/details/125829446?spm=1001.2014.3001.5502" target="_blank" rel="noopener noreferrer">hive优化<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="_7-5-5-hive-数据倾斜解决方案"><a href="#_7-5-5-hive-数据倾斜解决方案" class="header-anchor">#</a> 7.5.5 HIVE 数据倾斜解决方案</h3> <p><a href="https://blog.csdn.net/EricLeiy/article/details/120202984?spm=1001.2101.3001.6650.4&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-4-120202984-blog-80866723.pc_relevant_multi_platform_whitelistv4&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-4-120202984-blog-80866723.pc_relevant_multi_platform_whitelistv4&amp;utm_relevant_index=5" target="_blank" rel="noopener noreferrer">hive调优和数据倾斜解决方案<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/blog/handbook/bigdata/flume.html" class="prev">
          第六章 Flume
        </a></span> <span class="next"><a href="/blog/handbook/bigdata/scala.html">
          第八章 Scala
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-7115df4a data-v-1c636796><li class="level-2" data-v-7115df4a><a href="/blog/handbook/bigdata/hive.html#_7-1-hive概念" class="sidebar-link reco-side-_7-1-hive概念" data-v-7115df4a>7.1  HIVE概念</a></li><li class="level-2" data-v-7115df4a><a href="/blog/handbook/bigdata/hive.html#_7-2-hive-架构和原理" class="sidebar-link reco-side-_7-2-hive-架构和原理" data-v-7115df4a>7.2  HIVE 架构和原理</a></li><li class="level-2" data-v-7115df4a><a href="/blog/handbook/bigdata/hive.html#_7-3-hive-安装和连接" class="sidebar-link reco-side-_7-3-hive-安装和连接" data-v-7115df4a>7.3  HIVE 安装和连接</a></li><li class="level-2" data-v-7115df4a><a href="/blog/handbook/bigdata/hive.html#_7-4-hive基础操作" class="sidebar-link reco-side-_7-4-hive基础操作" data-v-7115df4a>7.4  HIVE基础操作</a></li><li class="level-2" data-v-7115df4a><a href="/blog/handbook/bigdata/hive.html#_7-5-hive进阶" class="sidebar-link reco-side-_7-5-hive进阶" data-v-7115df4a>7.5 HIVE进阶</a></li><li class="level-3" data-v-7115df4a><a href="/blog/handbook/bigdata/hive.html#_7-5-1-常见的数据类型" class="sidebar-link reco-side-_7-5-1-常见的数据类型" data-v-7115df4a>7.5.1 常见的数据类型</a></li><li class="level-3" data-v-7115df4a><a href="/blog/handbook/bigdata/hive.html#_7-5-2-hive中的表类型" class="sidebar-link reco-side-_7-5-2-hive中的表类型" data-v-7115df4a>7.5.2 HIVE中的表类型</a></li><li class="level-3" data-v-7115df4a><a href="/blog/handbook/bigdata/hive.html#_7-5-3-hive-函数的使用" class="sidebar-link reco-side-_7-5-3-hive-函数的使用" data-v-7115df4a>7.5.3 HIVE 函数的使用</a></li><li class="level-3" data-v-7115df4a><a href="/blog/handbook/bigdata/hive.html#_7-5-4-hive-优化" class="sidebar-link reco-side-_7-5-4-hive-优化" data-v-7115df4a>7.5.4 HIVE 优化</a></li><li class="level-3" data-v-7115df4a><a href="/blog/handbook/bigdata/hive.html#_7-5-5-hive-数据倾斜解决方案" class="sidebar-link reco-side-_7-5-5-hive-数据倾斜解决方案" data-v-7115df4a>7.5.5 HIVE 数据倾斜解决方案</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-65133105 data-v-65133105><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-65133105><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-65133105></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-65133105></path></svg></div><canvas id="vuepress-canvas-cursor"></canvas><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:50px;bottom:-70px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div></div></div>
    <script src="/blog/assets/js/app.f600c34c.js" defer></script><script src="/blog/assets/js/3.1aae9359.js" defer></script><script src="/blog/assets/js/1.ae8a88ec.js" defer></script><script src="/blog/assets/js/45.96aaada5.js" defer></script>
  </body>
</html>
