(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{507:function(s,a,e){"use strict";e.r(a);var t=e(2),n=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),a("h2",{attrs:{id:"_1-docker基本概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-docker基本概念"}},[s._v("#")]),s._v(" 1.docker基本概念")]),s._v(" "),a("h3",{attrs:{id:"docker是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker是什么"}},[s._v("#")]),s._v(" Docker是什么")]),s._v(" "),a("p",[s._v("Docker 是一个开源的应用容器引擎，基于 Go 语言 并遵从 Apache2.0 协议开源。Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。")]),s._v(" "),a("h3",{attrs:{id:"项目部署的三个阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目部署的三个阶段"}},[s._v("#")]),s._v(" 项目部署的三个阶段")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("物理机")]),s._v(" "),a("p",[s._v("部署一个服务，会粗略估计服务所需要的机器性能，然后去采购对应的真实物理机器，然后在该机器上安装服务需要的一些软件，比如服务器Tomcat，数据库MySQL等等。")]),s._v(" "),a("blockquote",[a("p",[s._v("物理机时代缺点")]),s._v(" "),a("p",[s._v("1、部署非常慢：采购机器，安装系统，安装软件等等；")]),s._v(" "),a("p",[s._v("2、成本高以及资源浪费：通常为了以防服务性能不够，我们都会尽量采购比预期资源高一点的机器，不仅会增加成本，还会造成机器资源浪费；")]),s._v(" "),a("p",[s._v("3、难于扩展与迁移：由于是真实的物理机，扩展或者迁移会比较麻烦；")])])]),s._v(" "),a("li",[a("p",[s._v("虚拟机")]),s._v(" "),a("p",[s._v("虚拟机能够在一台机器上创建多台机器，能够充分利用资源，并且也做到了机器之间的隔离，机器性能不够用了，也可以通过 Hypervisor 随时进行扩展。")]),s._v(" "),a("blockquote",[a("p",[s._v("虚拟机时代缺点")]),s._v(" "),a("p",[s._v("每一台虚拟机都要独立安装操作系统，大家知道操作系统其实也是比较占用性能的，有多少台虚拟机，我们就得多安装多少个操作系统，这样就浪费了很多资源。")])])]),s._v(" "),a("li",[a("p",[s._v("容器化")]),s._v(" "),a("p",[s._v("可以把容器看做是不用安装操作系统的虚拟机，容器化技术比虚拟机更加灵活，更加小巧，更加极致的利用物理机资源。")])])]),s._v(" "),a("h3",{attrs:{id:"docker出现原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker出现原因"}},[s._v("#")]),s._v(" Docker出现原因")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("一次构建，到处运行")]),s._v(" "),a("p",[s._v("通过 Docker 打包镜像发布测试，提供了一个标准化的解决方案，再也不用担心因为环境不一致而导致的服务部署问题。")])]),s._v(" "),a("li",[a("p",[s._v("更高效的计算资源利用")]),s._v(" "),a("p",[s._v("容器类似于 VM，但是它们具有被放宽的隔离属性，可以在应用程序之间共享操作系统（OS）。因此，容器被认为是轻量级的。容器与 VM  类似，具有自己的文件系统、CPU、内存、进程空间等。可以把容器看做是不用安装操作系统的虚拟机，容器化技术比虚拟机更加灵活，更加小巧，更加极致的利用物理机资源。")]),s._v(" "),a("blockquote",[a("p",[s._v("记住最重要的一点，Dokcer实际是宿主机的一个普通的进程，这也是Dokcer与传统虚拟化技术的最大不同。")])])])]),s._v(" "),a("h3",{attrs:{id:"docker优点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker优点"}},[s._v("#")]),s._v(" Docker优点")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("部署快,开发测试更加敏捷")]),s._v(" "),a("p",[s._v("通过Docker 打包镜像发布测试，一键运行。")])]),s._v(" "),a("li",[a("p",[s._v("快速扩展机器")]),s._v(" "),a("p",[s._v("由于Docker容器快速启动特性，可以很快速的启动几十个、上百个容器来提供更多并发和资源利用率，并且这么多容器也有比较成熟的解决方案来统一管理，比如K8S。")])]),s._v(" "),a("li",[a("p",[s._v("提高系统利用率,降低硬件成本")]),s._v(" "),a("p",[s._v("轻量级的虚拟机，更省资源。")])]),s._v(" "),a("li",[a("p",[s._v("跨环境可移植")])]),s._v(" "),a("li",[a("p",[s._v("更好的支持微服务")]),s._v(" "),a("p",[s._v("微服务是近几年来IT圈内谈论比较多的一个名词，意义也很简单：尽可能细粒度拆分业务程序架构，由多个独立服务组成业务系统。")]),s._v(" "),a("p",[s._v("而Docker的容器设计原则：一个容器一个服务，容器之间相互隔离，和微服务正好遥相呼应。")])]),s._v(" "),a("li",[a("p",[s._v("应用运维标准化,支持不同语言系统")])]),s._v(" "),a("li",[a("p",[s._v("避免云厂商锁定")])])]),s._v(" "),a("h3",{attrs:{id:"容器和虚拟机的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器和虚拟机的区别"}},[s._v("#")]),s._v(" 容器和虚拟机的区别")]),s._v(" "),a("p",[s._v("容器包括应用程序及其所有依赖项。容器运行时，与宿主机共享操作系统内核，容器在linux内核层面（使用 "),a("a",{attrs:{href:"https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Resource_Management_Guide/ch01.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Cgroups"),a("OutboundLink")],1),s._v(" 和 "),a("a",{attrs:{href:"https://lwn.net/Articles/528078/",target:"_blank",rel:"noopener noreferrer"}},[s._v("namespaces"),a("OutboundLink")],1),s._v("）来实现进程间的隔离，容器在主机操作系统上的用户空间中作为独立进程运行。")]),s._v(" "),a("p",[s._v("因此，容器相比于虚拟机更加轻量化，它体积小，启动快，占用资源少，性能好。")]),s._v(" "),a("p",[s._v("虚拟机使用虚拟化技术，应用程序运行在完整的操作系统（OS）之上，因此占用的资源更多，安装更复杂。")]),s._v(" "),a("p",[s._v("但是由于容器与宿主机共享内核，所以在隔离性和安全性方面不如虚拟机。")]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/docker.assets/image-20230807095538219.png",alt:"image-20230807095538219"}})]),s._v(" "),a("h3",{attrs:{id:"docker学习网站"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker学习网站"}},[s._v("#")]),s._v(" Docker学习网站")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://docs.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://hub.docker.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方仓库地址"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://vuepress.mirror.docker-practice.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker从入门到实践"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://docker.easydoc.net/doc/81170005/cCewZWoN/lTKfePfP",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker 快速入门"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.yuque.com/wukong-zorrm/xwas40",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker一小时入门教程"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"_2-docker安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-docker安装"}},[s._v("#")]),s._v(" 2.docker安装")]),s._v(" "),a("h3",{attrs:{id:"docker卸载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker卸载"}},[s._v("#")]),s._v(" docker卸载")]),s._v(" "),a("p",[s._v("要在 CentOS 中完全卸载 Docker，您可以按照以下步骤进行操作：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("停止所有正在运行的 Docker 容器。您可以使用以下命令停止所有容器：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aq")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("停止服务")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl stop docker.service\nsystemctl stop docker.socket\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("删除所有的 Docker 容器。运行以下命令删除所有容器：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aq")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("删除所有的 Docker 镜像。执行以下命令删除所有镜像：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aq")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("注意：这将删除所有已下载的 Docker 镜像，包括您自己构建的和来自 Docker Hub 的镜像。如果您希望保留某些镜像，请在执行此命令之前备份它们。")])]),s._v(" "),a("li",[a("p",[s._v("卸载 Docker 引擎。执行以下命令卸载 Docker 包：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum remove docker-ce docker-ce-cli containerd.io\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("删除 Docker 的相关文件和目录。执行以下命令删除相关文件和目录：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /etc/docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看数据卷并删除")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看数据卷")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除数据卷")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("volume_name_or_id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"在线安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在线安装"}},[s._v("#")]),s._v(" 在线安装")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("查看centos版本")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@oracleflink ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/centos-release")]),s._v("\nCentOS Linux release "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.9")]),s._v(".2009 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看当前的内核版本")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@oracleflink ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uname -r")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),s._v(".0-1160.80.1.el7.x86_64\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[s._v("内核版本不是3.10及以上的需要升级,"),a("a",{attrs:{href:"https://www.linuxprobe.com/update-kernel-centos7.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("centos7升级内核方法"),a("OutboundLink")],1)])])]),s._v(" "),a("li",[a("p",[s._v("使用root权限更新yum包(非必须)")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" update\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("yum -y update:升级所有包同时也升级软件和系统内核")]),s._v(" "),a("p",[s._v("yum -y upgrade:只升级所有包，不升级软件和系统内核")]),s._v(" "),a("p",[s._v("注意:这个命令不是必须的，看个人情况，后面出现不兼容的情况的话就必须update了。")])])]),s._v(" "),a("li",[a("p",[s._v("卸载旧版本(非必须)")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum remove "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("安装需要的软件包")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" yum-utils device-mapper-persistent-data lvm2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("yum-util 提供 yum-config-manager功能")]),s._v(" "),a("p",[s._v("device-mapper-persistent-data；lvm2是devicemapper驱动依赖")])])]),s._v(" "),a("li",[a("p",[s._v("查看yum 仓库")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@oracleflink ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /etc/yum.repos.d/")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v("\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1664")]),s._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" CentOS-Base.repo\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1309")]),s._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" CentOS-CR.repo\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("649")]),s._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" CentOS-Debuginfo.repo\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("314")]),s._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" CentOS-fasttrack.repo\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("630")]),s._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" CentOS-Media.repo\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1331")]),s._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" CentOS-Sources.repo\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8515")]),s._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" CentOS-Vault.repo\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("616")]),s._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" CentOS-x86_64-kernel.repo\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2081")]),s._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":13 docker-ce.repo\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1946")]),s._v(" Jul "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":08 elrepo.repo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("blockquote",[a("p",[s._v("如果用的厂商的服务器（阿里云、腾讯云）一般都会有docker仓库，如果用的是虚拟机或者公司的服务器基本s上没有。")])])]),s._v(" "),a("li",[a("p",[s._v("设置docker,yum源")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum-config-manager --add-repo http://download.docker.com/linux/centos/docker-ce.repo\nyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\nyum-config-manager --add-repo https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/docker-ce.repo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("blockquote",[a("p",[s._v("上面两个地址三选一，Docker官方提供的Docker Registry镜像仓库是Docker  Hub，但是国内访问这些服务可能比较慢，因此国内的一些云服务商提供了针对Docker Hub的镜像服务（Registry  Mirror），这些镜像服务被称为加速器。使用加速器会直接从国内的地址下载Docker Hub的镜像。注意如果下载镜像较慢可以配置镜像加速服务 ，"),a("a",{attrs:{href:"https://www.runoob.com/docker/docker-mirror-acceleration.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置镜像加速"),a("OutboundLink")],1)])])]),s._v(" "),a("li",[a("p",[s._v("配置镜像加速(非必须)")]),s._v(" "),a("div",{staticClass:"language-sehll line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[root@oracleflink ~]# cat /etc/docker/daemon.json \n{\n"registry-mirrors" : [\n    "https://docker.mirrors.ustc.edu.cn",\n    "https://hub-mirror.c.163.com",\n    "https://mirror.ccs.tencentyun.com",\n    "https://fsp2sfpr.mirror.aliyuncs.com/",\n    "https://registry.docker-cn.com"\n  ]\n}\n# 修改配置后需要重启docker 服务\n[root@oracleflink ~]# systemctl restart docker\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("blockquote",[a("p",[s._v("常见的镜像加速器地址")]),s._v(" "),a("ul",[a("li",[s._v("Docker 中国官方镜像 https://registry.docker-cn.com")]),s._v(" "),a("li",[s._v("DaoCloud 镜像站 http://f1361db2.m.daocloud.io")]),s._v(" "),a("li",[s._v("Azure 中国镜像 https://dockerhub.azk8s.cn")]),s._v(" "),a("li",[s._v("中科大镜像站 https://docker.mirrors.ustc.edu.cn")]),s._v(" "),a("li",[s._v("阿里云 https://<your_code>.mirror.aliyuncs.com\n需要先在阿里云注册并登录，点击“创建我的容器镜像”, 进入管理界面，\n然后点击“镜像加速器” ，可获得镜像加速器连接。")]),s._v(" "),a("li",[s._v("七牛云 https://reg-mirror.qiniu.com")]),s._v(" "),a("li",[s._v("网易云 https://hub-mirror.c.163.com")]),s._v(" "),a("li",[s._v("腾讯云 https://mirror.ccs.tencentyun.com")])]),s._v(" "),a("p",[a("strong",[s._v("注意要启动docker后才有"),a("code",[s._v("/etc/docker")]),s._v(" 这个文件夹 "),a("code",[s._v("daemon.json")]),s._v("文件自己建")])])])]),s._v(" "),a("li",[a("p",[s._v("安装docker")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io docker-compose-plugin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[a("code",[s._v("docker-ce")]),s._v(" 是 Docker Community Edition（社区版）的缩写，它是 Docker 的开源版本，提供了容器化应用程序的构建、分发和运行环境。")]),s._v(" "),a("p",[a("code",[s._v("docker-ce-cli")]),s._v(" 是 Docker 的命令行界面工具，用于与 Docker 守护进程进行交互，管理容器和镜像等操作。")]),s._v(" "),a("p",[a("code",[s._v("containerd.io")]),s._v(" 是 Docker 使用的容器运行时，它负责管理容器的生命周期、镜像管理和容器的执行环境。")]),s._v(" "),a("p",[a("code",[s._v("docker-compose-plugin")]),s._v(" 是 Docker Compose 的插件，Docker Compose 是一个用于定义和运行多个 Docker 容器的工具，它使用一个 YAML 文件来配置应用程序的服务、网络和存储等。")]),s._v(" "),a("p",[s._v("注意:默认执行"),a("code",[s._v("yum install docker-ce")]),s._v("就可以了,后面两个依赖不是必须的")])])]),s._v(" "),a("li",[a("p",[s._v("启动docker")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("设置开机启动")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" containerd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("验证是否安装成功")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"离线安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#离线安装"}},[s._v("#")]),s._v(" 离线安装")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("准备安装包")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载地址")]),s._v("\nhttps://download.docker.com/linux/static/stable/x86_64/docker-18.09.6.tgz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("解压缩安装包")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-zxvf")]),s._v(" docker-18.09.6.tgz \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("复制解压缩后的文件到指定文件夹")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" cp docker/* /usr/bin/ \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("注册编辑docker服务")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/systemd/system/docker.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("复制下列内容到该文档中")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Unit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Docker Application Container Engine\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Documentation")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://docs.docker.com\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("After")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("network-online.target firewalld.service\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Wants")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("network-online.target\n  \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("notify\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# the default is not to use systemd for cgroups because the delegate issues still")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exists and systemd currently does not support the cgroup feature set required")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# for containers run by docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/dockerd\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecReload")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/bin/kill "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" HUP "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MAINPID")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Having non-zero Limit*s causes performance problems due to accounting overhead")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# in the kernel. We recommend using cgroups to do container-local accounting.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LimitNOFILE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("infinity\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LimitNPROC")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("infinity\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LimitCORE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("infinity\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Uncomment TasksMax if your systemd version supports it.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Only systemd 226 and above support this version.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#TasksMax=infinity")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TimeoutStartSec")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# set delegate yes so that systemd does not reset the cgroups of docker containers")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Delegate")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kill only the docker process, not all processes in the cgroup")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("KillMode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("process\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restart the docker process if it exits prematurely")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("on-failure\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("StartLimitBurst")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("StartLimitInterval")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("60s\n  \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WantedBy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("multi-user.target\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("添加权限后启动")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /etc/systemd/system/docker.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("重新加载配置文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl daemon-reload\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("启动Docker")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("设置开机自启")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("验证是否安装成功")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看docker 状态")]),s._v("\nsystemctl status "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看docker版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"_3-docker概念与执行流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-docker概念与执行流程"}},[s._v("#")]),s._v(" 3.docker概念与执行流程")]),s._v(" "),a("h3",{attrs:{id:"容器化平台"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器化平台"}},[s._v("#")]),s._v(" 容器化平台")]),s._v(" "),a("p",[s._v("Docker 是提供应用打包，部署与运行应用的容器化平台。")]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/docker.assets/image-20221123101715501.png",alt:"image-20221123101715501"}})]),s._v(" "),a("h3",{attrs:{id:"docker引擎"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker引擎"}},[s._v("#")]),s._v(" Docker引擎")]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/docker.assets/image-20221123101847629.png",alt:"image-20221123101847629"}})]),s._v(" "),a("ul",[a("li",[a("p",[s._v("docker daemon")]),s._v(" "),a("p",[s._v("Docker的服务端组件，他是Docker架构中运行在后台的一个守护进程，可以接收并处理来自命令行接口及API接口的指令，然后进行相应的后台操作。")])]),s._v(" "),a("li",[a("p",[s._v("REST API")]),s._v(" "),a("p",[s._v("表示应用程序API接口，开发者通过该API接口可以与Docker的守护进程进行交互，从而指示后台进行相关操作。")])]),s._v(" "),a("li",[a("p",[s._v("docker CLI")]),s._v(" "),a("p",[s._v("表示Docker命令行接口，开发者可以在命令行中使用Docker相关指令与Docker守护进程进行交互，从而管理诸如image(镜像)、container(容器)、network(网络)和data volumes(数据卷)等实体。")])])]),s._v(" "),a("h3",{attrs:{id:"容器-镜像-registry-镜像仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器-镜像-registry-镜像仓库"}},[s._v("#")]),s._v(" 容器,镜像,registry 镜像仓库")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("registry 镜像仓库")]),s._v(" "),a("p",[s._v("registry可以理解为镜像仓库，用于保存docker image。Docker Hub 是docker官方的镜像仓库，docker命令默认从docker hub中拉取镜像。我们也可以搭建自己的镜像仓库。")])]),s._v(" "),a("li",[a("p",[s._v("镜像")]),s._v(" "),a("p",[s._v("可以类似Java中的类。image可以理解为一个只读的应用模板。image包含了应用程序及其所需要的依赖环境，例如可执行文件、环境变量、初始化脚本、启动命令等。")])]),s._v(" "),a("li",[a("p",[s._v("容器类的实例化,对象")]),s._v(" "),a("p",[s._v("容器是image的一个运行实例。当我们运行一个image，就创建了一个容器。")])])]),s._v(" "),a("blockquote",[a("p",[s._v("一个仓库可以存放多个镜像，一个镜像可以构建多个容器。")])]),s._v(" "),a("h3",{attrs:{id:"docker执行流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker执行流程"}},[s._v("#")]),s._v(" Docker执行流程")]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/docker.assets/image-20221123102324390.png",alt:"image-20221123102324390"}})]),s._v(" "),a("blockquote",[a("p",[s._v("客户端发送"),a("code",[s._v("docker pull Tomcat")]),s._v("  命令,命令到达 Docker daemon（守护程序），守护进程首先检查本地是否有该 "),a("code",[s._v("Tomcat")]),s._v(" 的镜像，如果没有，则从注册中心（仓库）拉取该镜像；镜像拉取到本地后，客户端执行 "),a("code",[s._v("docker run")]),s._v("命令，守护程序就会创建容器，启动应用。")])]),s._v(" "),a("h3",{attrs:{id:"docker-pull-命令详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-pull-命令详解"}},[s._v("#")]),s._v(" docker pull 命令详解")]),s._v(" "),a("p",[s._v("Docker Pull 命令是用来从 Docker 镜像仓库中拉取一个或多个镜像到本地主机的命令。执行 Docker Pull 命令后，Docker 客户端会首先检查本地主机是否已经存在该镜像，如果已经存在则直接使用本地的镜像，否则会从 Docker 镜像仓库中拉取对应的镜像。下面是 Docker Pull 命令的详细流程：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("解析镜像名称和标签")]),s._v(" "),a("p",[s._v("Docker Pull 命令需要提供要拉取的镜像名称和标签（tag），例如 "),a("code",[s._v("docker pull nginx:latest")]),s._v("。Docker 客户端会对这个名称进行解析，确定镜像所在的 Docker 镜像仓库地址、仓库名称和标签。")])]),s._v(" "),a("li",[a("p",[s._v("认证 Docker 镜像仓库")]),s._v(" "),a("p",[s._v("如果需要认证 Docker 镜像仓库，Docker 客户端会提示用户输入用户名和密码或者其他认证信息，以便向 Docker 镜像仓库发起认证请求。")])]),s._v(" "),a("li",[a("p",[s._v("检查本地主机是否已有该镜像")]),s._v(" "),a("p",[s._v("Docker 客户端会检查本地主机是否已经存在该镜像。如果本地主机已经有了该镜像，Docker 客户端会直接使用本地的镜像，否则会从 Docker 镜像仓库中拉取对应的镜像。")])]),s._v(" "),a("li",[a("p",[s._v("从 Docker 镜像仓库中拉取镜像")]),s._v(" "),a("p",[s._v("如果本地主机没有该镜像，Docker 客户端会向 Docker 镜像仓库发起拉取镜像的请求。Docker 镜像仓库会返回该镜像的所有层（layers），Docker 客户端会将这些层下载到本地主机，并根据层的依赖关系进行组装，最终生成完整的镜像。")])]),s._v(" "),a("li",[a("p",[s._v("保存镜像到本地主机")]),s._v(" "),a("p",[s._v("Docker 客户端会将拉取到的镜像保存到本地主机的 Docker 镜像缓存中，以便后续使用。Docker 镜像缓存一般位于 "),a("code",[s._v("/var/lib/docker")]),s._v(" 目录下，其中的 "),a("code",[s._v("image")]),s._v(" 目录存储了所有已经拉取到本地主机的镜像。")])]),s._v(" "),a("li",[a("p",[s._v("更新本地镜像索引")]),s._v(" "),a("p",[s._v("Docker 客户端会更新本地镜像索引（image index），以便在后续使用 "),a("code",[s._v("docker run")]),s._v(" 命令时能够快速地找到该镜像。本地镜像索引一般位于 "),a("code",[s._v("/var/lib/docker/image/docker/registry/v2/repositories")]),s._v(" 目录下。")])])]),s._v(" "),a("p",[s._v("总的来说，Docker Pull 命令的主要作用是从 Docker 镜像仓库中拉取镜像并保存到本地主机，以便在后续使用 "),a("code",[s._v("docker run")]),s._v(" 命令时能够快速地启动容器。")]),s._v(" "),a("h2",{attrs:{id:"_4-docker常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-docker常用命令"}},[s._v("#")]),s._v(" 4.docker常用命令")]),s._v(" "),a("h3",{attrs:{id:"万能帮助命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#万能帮助命令"}},[s._v("#")]),s._v(" 万能帮助命令")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("docker --help")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("docker 命令 --help")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@oracleflink ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run --help")]),s._v("\n\nUsage:  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" IMAGE "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("COMMAND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ARG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nRun a "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a new container\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/docker/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方命令文档参考"),a("OutboundLink")],1)])])]),s._v(" "),a("h3",{attrs:{id:"常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[s._v("#")]),s._v(" 常用命令")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("查看版本信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@oracleflink ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker version")]),s._v("\nClient: Docker Engine - Community\n Version:           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.10")]),s._v(".21\n API version:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.41")]),s._v("\n Go version:        go1.18.7\n Git commit:        baeda1f\n Built:             Tue Oct "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":04:24 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("\n OS/Arch:           linux/amd64\n Context:           default\n Experimental:      "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n\nServer: Docker Engine - Community\n Engine:\n  Version:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.10")]),s._v(".21\n  API version:      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.41")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Go version:       go1.18.7\n  Git commit:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3056208")]),s._v("\n  Built:            Tue Oct "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":02:38 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("\n  OS/Arch:          linux/amd64\n  Experimental:     "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n containerd:\n  Version:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.6")]),s._v(".9\n  GitCommit:        1c90a442489720eec95342e1789ee8a5e1b9536f\n runc:\n  Version:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v(".4\n  GitCommit:        v1.1.4-0-g5fd4c4d\n docker-init:\n  Version:          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.19")]),s._v(".0\n  GitCommit:        de40ad0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看系统信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"镜像常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像常用命令"}},[s._v("#")]),s._v(" 镜像常用命令")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("查看镜像")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@oracleflink ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY                                                               TAG           IMAGE ID       CREATED        SIZE\nmcr.microsoft.com/mssql/server                                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v("-latest   a03c94c3147d   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" months ago   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".33GB\nregistry.cn-hangzhou.aliyuncs.com/lhrbest/oracle_12cr2_ee_lhr_12.2.0.1   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v("           eb1a87913afe   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" years ago    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(".1GB\nregistry.cn-hangzhou.aliyuncs.com/zhuyijun/oracle-12c                    latest        2963f42e27a2   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" years ago    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(".01GB\nregistry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g                     latest        3fa112fd3642   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" years ago    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(".85GB\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("blockquote",[a("p",[s._v("REPOSITORY: 镜像仓库源")]),s._v(" "),a("p",[s._v("TAG：镜像版本，latest 表示最新版本")]),s._v(" "),a("p",[s._v("IMAGE ID：镜像ID（特别重要）")]),s._v(" "),a("p",[s._v("CREATED：创建时间")]),s._v(" "),a("p",[s._v("SIZE：镜像大小。")])])]),s._v(" "),a("li",[a("p",[s._v("搜索镜像")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@oracleflink ~]# docker search docker\nNAME          DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED\nnginx         Official build of Nginx.                        17721     [OK]       \nubuntu        Ubuntu is a Debian-based Linux operating sys…   15255     [OK]       \nmysql         MySQL is a widely used, open-source relation…   13504     [OK]       \nnode          Node.js is a JavaScript-based platform for s…   12133     [OK]       \npostgres      The PostgreSQL object-relational database sy…   11693     [OK]       \nredis         Redis is an open source key-value store that…   11590     [OK]       \nalpine        A minimal Docker image based on Alpine Linux…   9450      [OK]       \nmongo         MongoDB document databases provide high avai…   9283      [OK]       \npython        Python is an interpreted, interactive, objec…   8164      [OK]       \ncentos        DEPRECATED; The official build of CentOS.       7408      [OK]       \nmariadb       MariaDB Server is a high performing open sou…   5155      [OK]       \nwordpress     The WordPress rich content management system…   5001      [OK]       \nrabbitmq      RabbitMQ is an open source multi-protocol me…   4560      [OK]       \ndebian        Debian is a Linux distribution that's compos…   4504      [OK]       \ngolang        Go (golang) is a general purpose, higher-lev…   4356      [OK]       \nhttpd         The Apache HTTP Server Project                  4247      [OK]       \nregistry      The Docker Registry 2.0 implementation for s…   3721      [OK]       \nopenjdk       Pre-release / non-production builds of OpenJ…   3495      [OK]       \nbusybox       Busybox base image.                             2822      [OK]       \ntraefik       Traefik, The Cloud Native Edge Router           2726      [OK]       \ndocker        Docker in Docker!                               2116      [OK]       \nmemcached     Free & open source, high-performance, distri…   1971      [OK]       \nhello-world   Hello World! (an example of minimal Dockeriz…   1906      [OK]       \ninfluxdb      InfluxDB is an open source time series datab…   1651      [OK]       \nconsul        Consul is a datacenter runtime that provides…   1355      [OK]  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("blockquote",[a("p",[a("code",[s._v("docker search <镜像名>")])]),s._v(" "),a("p",[s._v("NAME:镜像名称")]),s._v(" "),a("p",[s._v("DESCRIPTION：镜像描述")]),s._v(" "),a("p",[s._v("STARS：收藏数")]),s._v(" "),a("p",[s._v("OFFICIAL：是否官方")]),s._v(" "),a("p",[s._v("AUTOMATED：是否自动构建")]),s._v(" "),a("p",[s._v("也可以直接进入 "),a("a",{attrs:{href:"https://hub.docker.com/search?q=",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker hub网站直接搜索"),a("OutboundLink")],1)])])]),s._v(" "),a("li",[a("p",[s._v("下载镜像")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull 镜像名<:tags>")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull nginx:1.22\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[s._v("如果不指定tags，默认下载最新版.一般不建议使用latest，因为最新的镜像是滚动更新的，过一段时间，可能跟你本地的不是同一个。")])])]),s._v(" "),a("li",[a("p",[s._v("删除镜像")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根据名称和版本删除，如果不指定tag，默认是lastest")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi repository"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(":tag"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根据镜像id删除")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi IMAGE_ID    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 批量删除")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi IMAGE_ID1 IMAGE_ID2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"容器常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器常用命令"}},[s._v("#")]),s._v(" 容器常用命令")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("新建容器并启动")]),s._v(" "),a("div",{staticClass:"language-SHELL line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run <参数> 镜像id|镜像名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1522")]),s._v(":1522 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5501")]),s._v(":5501 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" oracle11g "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /oracle11g/oradata:/oracle11g/oradata registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[s._v("常用参数说明")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" IMAGE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":TAG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("COMMAND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ARG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  -d, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--detach")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false         指定容器运行于前台还是后台，默认为false     \n  -i, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--interactive")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false   打开STDIN，用于控制台交互    \n  -t, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tty")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false            分配tty设备，该可以支持终端登录，默认为false    \n  -u, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("              指定容器的用户    \n  -a, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--attach")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("            登录容器（必须是以docker run -d启动的容器）  \n  -w, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--workdir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("           指定容器的工作目录   \n  -c, --cpu-shares"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        设置容器CPU权重，在CPU共享场景使用    \n  -e, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--env")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("               指定环境变量，容器中可以使用该环境变量    \n  -m, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--memory")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("            指定容器的内存上限    \n  -P, --publish-all"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false    指定容器暴露的端口    \n  -p, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--publish")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("           指定容器暴露的端口   \n  -h, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--hostname")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("          指定容器的主机名    \n  -v, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--volume")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("            给容器挂载存储卷，挂载到容器的某个目录    \n  --volumes-from"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("          给容器挂载其他容器上的卷，挂载到容器的某个目录  \n  --cap-add"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("               添加权限    \n  --cap-drop"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("              删除权限    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--cidfile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("               运行容器后，在指定文件中写入容器PID值，一种典型的监控系统用法    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--cpuset")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("                设置容器可以使用哪些CPU，此参数可以用来容器独占CPU    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--device")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                添加主机设备给容器，相当于设备直通    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--dns")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                   指定容器的dns服务器    \n  --dns-search"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("            指定容器的dns搜索域名，写入到容器的/etc/resolv.conf文件    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--entrypoint")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("            覆盖image的入口点    \n  --env-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("              指定环境变量文件，文件格式为每行一个环境变量    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--expose")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                指定容器暴露的端口，即修改镜像的暴露端口    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--link")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                  指定容器间的关联，使用其他容器的IP、env等信息    \n  --lxc-conf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("              指定容器的配置文件，只有在指定--exec-driver"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("lxc时使用    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("                  指定容器名字，后续可以通过名字进行容器管理，links特性需要使用名字    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--net")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v("             容器网络设置:  \n                             bridge 使用docker daemon指定的网桥       \n                             "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("   //容器使用主机的网络    \n                             container:NAME_or_ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("//使用其他容器的网络，共享IP和PORT等网络资源    \n                             none 容器使用自己的网络（类似--net"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bridge），但是不进行配置   \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false         指定容器是否为特权容器，特权容器拥有所有的capabilities    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no"')]),s._v("             指定容器停止后的重启策略:  \n                             no：容器退出时不重启    \n                             on-failure：容器故障退出（返回值非零）时重启   \n                             always：容器退出时总是重启    \n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false                 指定容器停止后自动删除容器"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("不支持以docker run -d启动的容器"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    \n  --sig-proxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true           设置由代理接受并处理信号，但是SIGCHLD、SIGSTOP和SIGKILL不能被代理    \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])])])]),s._v(" "),a("li",[a("p",[s._v("进入容器")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法一 使用run方式在创建时进入")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("镜像名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" /bin/bash\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法二 使用 attach 命令（进入已启动的容器）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" attach --sig-proxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false 容器名称"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器ID\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法三 使用 exec 命令（进入已启动的容器）一般使用这个方法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" 容器名称"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器ID  /bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("退出容器")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法一")]),s._v("\nCtrl+P+Q "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 仅退出容器，不关闭容器\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法二")]),s._v("\nexit: 关闭容器并退出。\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法三")]),s._v("\nctr + d ：同方法二，方法二的快捷方式\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看所有运行的容器")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1、查看正在运行的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2、查看正在运行的容器的ID")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-q")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3、查看正在运行+历史运行过的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4、显示运行容器总文件大小")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("停止与删除容器")]),s._v(" "),a("div",{staticClass:"language-SHELL line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.停止一个运行中的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop 容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器id\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.杀掉一个运行中的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" 容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器id\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.删除一个已停止的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器id\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.删除一个运行中的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" 容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("容器重启")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart 容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("容器关闭")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop 容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("容器启动")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start 容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看容器日志")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker logs <参数>容器名|容器id")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("参数:")]),s._v(" "),a("p",[s._v("-f  跟踪日志输出")]),s._v(" "),a("p",[s._v("-t：显示时间戳")]),s._v(" "),a("p",[s._v("--tail N：仅列出最后N条日志")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://kuizuo.cn/en/docs/docker-container-log-clean",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker容器日志过大清理"),a("OutboundLink")],1)])])]),s._v(" "),a("li",[a("p",[s._v("查看容器进程")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker top 容器ID|容器名")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看容器暴露的端口")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker port 容器ID|容器名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker port ruoyi-java")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8081\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":8081\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看容器信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker inspect 容器ID|容器名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器IP")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}'")]),s._v(" db-mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("修改容器名称")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker rename 旧容器名称 新容器名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rename")]),s._v(" docker-compose-wordpress-1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("新容器名称"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("主机和容器之间数据复制")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将容器中的文件copy至本地路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器ID:/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("container_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("local_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /www/runoob 96f7f14e99ab:/www/\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将主机文件copy至容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("local_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器ID:/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("container_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将主机文件copy至容器，目录重命名为[container_path]（注意与非重命名copy的区别）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /www/runoob 96f7f14e99ab:/www\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("blockquote",[a("p",[a("a",{attrs:{href:"https://www.runoob.com/docker/docker-cp-command.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("cp命令参考"),a("OutboundLink")],1)])])])]),s._v(" "),a("h2",{attrs:{id:"_5-docker网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-docker网络"}},[s._v("#")]),s._v(" 5.docker网络")]),s._v(" "),a("h3",{attrs:{id:"docker网络分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker网络分类"}},[s._v("#")]),s._v(" docker网络分类")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("网络查看")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network ls")]),s._v("\nNETWORK ID     NAME                       DRIVER    SCOPE\nb5ceee1d0e2b   bridge                     bridge    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n406f713d001a   docker-compose_default     bridge    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\nb072f05ac81e   docker-compose_ruoyi-net   bridge    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n267f6d502cc3   harbor-portal_default      bridge    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\na69e7dfb3477   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n204deb3307eb   my-net                     bridge    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\nba22e0c6f61f   none                       null      "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n7e81235f79b3   ruoyi-net                  bridge    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("网络分类")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("bridge")]),s._v(" "),a("p",[s._v("如果不指定，新创建的容器默认将连接到bridge网络。默认情况下，使用bridge网络，宿主机可以ping通容器ip，容器中也能ping通宿主机。容器之间只能通过 IP 地址相互访问，由于容器的ip会随着启动顺序发生变化，因此不推荐使用ip访问。")]),s._v(" "),a("blockquote",[a("p",[s._v("由于很多镜像为精简镜像，可能很多Linux命令没有，可以使用 busybox测试一些Linux 命令。"),a("a",{attrs:{href:"https://blog.csdn.net/m0_67391683/article/details/124169685",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker 工具 busybox"),a("OutboundLink")],1)])])]),s._v(" "),a("li",[a("p",[s._v("host")]),s._v(" "),a("p",[s._v("容器与宿主机共享网络，不需要映射端口即可通过宿主机IP访问。（-p选项会被忽略）主机模式网络可用于优化性能，在容器需要处理大量端口的情况下，它不需要网络地址转换 （NAT），并且不会为每个端口创建“用户空间代理”。")])]),s._v(" "),a("li",[a("p",[s._v("none")]),s._v(" "),a("p",[s._v("禁用容器中所用网络，在启动容器时使用。")])])])])]),s._v(" "),a("h3",{attrs:{id:"用户自定义网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户自定义网络"}},[s._v("#")]),s._v(" 用户自定义网络")]),s._v(" "),a("p",[s._v("在用户自定义网络上，容器之间可以通过容器名进行访问。用户自定义网络使用 Docker 的嵌入式 DNS 服务器将容器名解析成 IP。")]),s._v(" "),a("p",[s._v("使用步骤如下")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("创建用户自定义网络")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create my-net\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("将已有容器连接到此网络")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network connect my-net db-mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("创建容器时指定网络。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--network")]),s._v(" my-net mysql:5.7 mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" db-mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-uroot")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"docker主机名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker主机名"}},[s._v("#")]),s._v(" docker主机名")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("主机名查看")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker inspect <容器名称或容器ID> | grep "Hostname" ')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker inspect wordpress | grep "Hostname"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"HostnamePath"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/docker/containers/8abec2e8548172d7761624e822da675dd973c1c1500e41f99e27bf6818f5504c/hostname"')]),s._v(",\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hostname"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8abec2e85481"')]),s._v(",\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("blockquote",[a("p",[s._v("容器的hostname默认为容器的 ID。")])])]),s._v(" "),a("li",[a("p",[s._v("主机名修改")]),s._v(" "),a("p",[s._v("在容器内手动修改/etc/hosts文件，容器重启后会恢复默认配置。要是/etc/hosts修改生效，使用"),a("code",[s._v("--add-host")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方式一")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --add-host"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("my-alpine:172.17.0.3 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" alpine:3.15\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方式二")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--hostname")]),s._v(" my-alpine "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" my-alpine  alpine:3.15\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"docker容器间通信方式总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker容器间通信方式总结"}},[s._v("#")]),s._v(" docker容器间通信方式总结")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("利用容器ip访问")]),s._v(" "),a("p",[s._v("容器重启后，ip会发生变化。通过容器ip访问不是一个好的方案。")])]),s._v(" "),a("li",[a("p",[s._v("利用宿主机的"),a("code",[s._v("ip:port")]),s._v("访问")]),s._v(" "),a("p",[s._v("通过宿主机的ip:port访问，只能依靠监听在暴露出的端口的进程来进行有限的通信。")])]),s._v(" "),a("li",[a("p",[s._v("利用link建立连接进行通信(官方不推荐使用)")])]),s._v(" "),a("li",[a("p",[s._v("利用用户自定义网络("),a("code",[s._v("User-defined networks")]),s._v(")进行通信(官方推荐使用)")])])]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://www.php.cn/docker/488507.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("容器间通信"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"_6-docker数据存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-docker数据存储"}},[s._v("#")]),s._v(" 6.docker数据存储")]),s._v(" "),a("h3",{attrs:{id:"docker存储概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker存储概念"}},[s._v("#")]),s._v(" docker存储概念")]),s._v(" "),a("p",[s._v("将数据存储在容器中，一旦容器被删除，数据也会被删除。同时也会使容器变得越来越大，不方便恢复和迁移。将数据存储到容器之外，这样删除容器也不会丢失数据。一旦容器故障，我们可以重新创建一个容器，将数据挂载到容器里，就可以快速的恢复。")]),s._v(" "),a("h3",{attrs:{id:"数据存储的方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据存储的方式"}},[s._v("#")]),s._v(" 数据存储的方式")]),s._v(" "),a("p",[s._v("docker有以下三种存储方式:")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("volume 卷")])]),s._v(" "),a("p",[a("strong",[s._v("卷")]),s._v("存储在主机文件系统分配一块专有存储区域，"),a("em",[s._v("由 Docker")]),s._v("（在 Linux 上）管理，并且与主机的核心功能隔离。非 Docker 进程不能修改文件系统的这一部分。卷是在 Docker 中持久保存数据的最佳方式。")]),s._v(" "),a("p",[s._v("卷 是docker 容器存储数据的首选方式，卷有以下优势：")]),s._v(" "),a("ul",[a("li",[s._v("卷可以在多个正在运行的容器之间共享数据。仅当显式删除卷时，才会删除卷。")]),s._v(" "),a("li",[s._v("当你想要将容器数据存储在外部网络存储上或云提供商上，而不是本地时。")]),s._v(" "),a("li",[s._v("卷更容易备份或迁移，当您需要备份、还原数据或将数据从一个 Docker 主机迁移到另一个 Docker 主机时，卷是更好的选择。")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建数据卷")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume create my-data\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/mysql/conf.d/my.cnf:/etc/mysql/conf.d/my.cnf:ro  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" my-data:/var/lib/mysql  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" mysql:5.7 \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建 nfs卷")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--driver")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--opt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nfs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--opt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("o")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.1,rw "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--opt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("device")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(":/path/to/dir "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    vol-nfs\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("bind mount 绑定挂载")])]),s._v(" "),a("p",[a("strong",[s._v("绑定挂载")]),s._v("可以将主机文件系统上目录或文件"),a("em",[s._v("装载到容器中")]),s._v("，但是主机上的非 Docker 进程可以修改它们，同时在"),a("strong",[s._v("容器")]),s._v("中也可以更改"),a("strong",[s._v("主机")]),s._v("文件系统，包括创建、修改或删除文件或目录，使用不当，可能会带来安全隐患。")]),s._v(" "),a("p",[s._v("绑定挂载适用以下场景：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("将配置文件从主机共享到容器。")])]),s._v(" "),a("li",[a("p",[s._v("在 Docker 主机上的开发环境和容器之间共享源代码或编译目录。")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("例如，可以将 Maven 的"),a("code",[s._v("target/")]),s._v("目录挂载到容器中，每次在主机上用 Maven打包项目时，容器内都可以使用新编译的程序包。")])])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/mysql/mysql.cnf:/etc/mysql/conf.d/mysql.cnf:ro  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/mysql/data:/var/lib/mysql  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" mysql:5.7 \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("blockquote",[a("p",[s._v("执行命令"),a("code",[s._v("docker run -it -v 宿主机目录:容器目录")])]),s._v(" "),a("p",[s._v("-v 绑定挂载")]),s._v(" "),a("p",[s._v("绑定挂载将主机上的目录或者文件装载到容器中。绑定挂载会覆盖容器中的目录或文件。")]),s._v(" "),a("p",[s._v("如果宿主机目录不存在，docker会自动创建这个目录。但是docker只自动创建文件夹，不会创建文件。")]),s._v(" "),a("p",[s._v("例如，mysql的配置文件和数据存储目录使用主机的目录。可以将配置文件设置为只读（read-only）防止容器更改主机中的文件。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("tmpfs")]),s._v(" "),a("strong",[s._v("临时挂载")])]),s._v(" "),a("p",[a("strong",[s._v("tmpfs挂载")]),s._v("仅存储在主机系统的内存中，从不写入主机系统的文件系统。当容器停止时，数据将被删除。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tmpfs")]),s._v(" /tmp nginx:1.22-alpine\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"数据卷的删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷的删除"}},[s._v("#")]),s._v(" 数据卷的删除")]),s._v(" "),a("p",[s._v("由于删除容器不会删除存储卷，要彻底删除信息应该删除容器后删除数据卷。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 停止容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop ruoyi-db\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 删除容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" ruoyi-db\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 删除容器对应的数据卷")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" ruoyi-data\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://zimug.blog.csdn.net/article/details/125039578",target:"_blank",rel:"noopener noreferrer"}},[s._v("容器间进行数据共享的三种方式"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"_7-部署自己的应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-部署自己的应用"}},[s._v("#")]),s._v(" 7. 部署自己的应用")]),s._v(" "),a("p",[s._v("完成若依admin安装")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("下载项目源码")])]),s._v(" "),a("li",[a("p",[s._v("修改yml配置文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 开发环境配置\nserver:\n  # 服务器的HTTP端口，默认为80\n  port: 8080\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("修改数据库连接配置")]),s._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("druid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主库数据源")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("master")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//ruoyi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3306/ry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("useUnicode=true"),a("span",{pre:!0,attrs:{class:"token important"}},[s._v("&characterEncoding=utf8")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("maven打包生成jar文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@gitlab app]# ll\ntotal 74004\n-rw-r--r--. 1 root root      113 Aug  4 16:02 Dockerfile\n-rw-r--r--. 1 root root 75774628 Aug  4 09:21 ruoyi-admin.jar\ndrwxr-xr-x. 2 root root       82 Aug  4 09:47 sql\n[root@gitlab app]# pwd\n/home/app\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("blockquote",[a("p",[s._v("将打包生成的jar文件放在以上目录，sql目录存放初始化SQL脚本。")])])]),s._v(" "),a("li",[a("p",[s._v("创建数据卷和网络")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 创建数据卷")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume create ruoyi-data\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 创建用户自定义网络")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create ruoyi-net\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("部署MySQL并初始化")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_DATABASE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ry "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t\t  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/app/sql:/docker-entrypoint-initdb.d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" ruoyi-data:/var/lib/mysql  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--network")]),s._v(" ruoyi-net "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" ruoyi-db "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" mysql:5.7 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           --character-set-server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8mb4 --collation-server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8mb4_unicode_ci\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("blockquote",[a("p",[s._v("注意这里的--name ruoyi-db 是要和数据库连接串中的ruoyi-db保持一致")])])]),s._v(" "),a("li",[a("p",[s._v("解决乱码问题")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@gitlab app]# docker exec -it ruoyi-db mysql -uroot -p\nEnter password: \nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 7\nServer version: 5.7.43 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2023, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> show variables like '%char%';\n+--------------------------+----------------------------+\n| Variable_name            | Value                      |\n+--------------------------+----------------------------+\n| character_set_client     | utf8                       |\n| character_set_connection | utf8                       |\n| character_set_database   | utf8mb4                    |\n| character_set_filesystem | binary                     |\n| character_set_results    | utf8                       |\n| character_set_server     | utf8mb4                    |\n| character_set_system     | utf8                       |\n| character_sets_dir       | /usr/share/mysql/charsets/ |\n+--------------------------+----------------------------+\n8 rows in set (0.01 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("blockquote",[a("p",[s._v("修改编码为utf8mb4")]),s._v(" "),a("p",[s._v("乱码问题参考:https://github.com/docker-library/mysql/issues/131")])])]),s._v(" "),a("li",[a("p",[s._v("部署"),a("code",[s._v("ruoyi-admin")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v(":8080 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t\t  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/app/ruoyi-admin.jar:/usr/local/src/ruoyi-admin.jar "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--network")]),s._v(" ruoyi-net "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" ruoyi-java "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t\t  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" openjdk:8u342-jre "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-jar")]),s._v(" /usr/local/src/ruoyi-admin.jar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"_8-docker-compose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-docker-compose"}},[s._v("#")]),s._v(" 8.docker compose")]),s._v(" "),a("h3",{attrs:{id:"docker-compose概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose概念"}},[s._v("#")]),s._v(" Docker Compose概念")]),s._v(" "),a("p",[s._v("Compose 是用于定义和运行多容器 Docker 应用程序的工具。通过 Compose，您可以使用 YML 文件来配置应用程序需要的所有服务。然后，使用一个命令，就可以从 YML 文件配置中创建并启动所有服务。")]),s._v(" "),a("h3",{attrs:{id:"出现原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#出现原因"}},[s._v("#")]),s._v(" 出现原因")]),s._v(" "),a("p",[s._v("在实际的生产中，一般都是使用一个docker容器部署一个应用进程，这种情况下，当部署多个不同应用或者一个应用部署多个实例的时候，就要运行多个容器。多个容器协同工作需要一个管理者来管理他们，定义这些容器如何相互关联。compose 就是做这件事的。")]),s._v(" "),a("blockquote",[a("p",[s._v("Docker Compose的主要作用是帮助我们批量有规则的管理容器。")])]),s._v(" "),a("h3",{attrs:{id:"一键部署wordpress"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一键部署wordpress"}},[s._v("#")]),s._v(" 一键部署wordpress")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://hub.docker.com/_/wordpress",target:"_blank",rel:"noopener noreferrer"}},[s._v("wordpress"),a("OutboundLink")],1),s._v("是一个著名的开源博客系统。将以下内容保存到本地的docker-compose.yml文件中。"),a("code",[s._v("docker compose")]),s._v("命令启动时，默认在当前目录下寻找"),a("code",[s._v("compose.yaml")]),s._v("或"),a("code",[s._v("compose.yml")]),s._v("，为了兼容之前的版本，也会查找"),a("code",[s._v("docker-compose.yaml")]),s._v("或"),a("code",[s._v("docker-compose.yml")]),s._v("。也可以使用"),a("code",[s._v("-f")]),s._v("参数手动指定文件"),a("code",[s._v("docker compose -f docker-compose-dev.yml up -d")])]),s._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("wordpress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wordpress\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 8085"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("WORDPRESS_DB_HOST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" db\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("WORDPRESS_DB_USER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" exampleuser\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("WORDPRESS_DB_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" examplepass\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("WORDPRESS_DB_NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" exampledb\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" wordpress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/www/html\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("db")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_DATABASE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" exampledb\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_USER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" exampleuser\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" examplepass\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_RANDOM_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/lib/mysql\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("wordpress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("db")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("h3",{attrs:{id:"docker-compose常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose常用命令"}},[s._v("#")]),s._v(" docker compose常用命令")]),s._v(" "),a("p",[a("code",[s._v("docker compose up -d")]),s._v("一键部署启动")]),s._v(" "),a("p",[a("code",[s._v("docker compose start/stop")]),s._v("启动/停止服务")]),s._v(" "),a("p",[a("code",[s._v("docker compose down")]),s._v("停止并删除容器，不会删除存储卷volume")]),s._v(" "),a("p",[a("code",[s._v("docker compose -f docker-compose-dev.yml up -d")]),s._v(" 手动指定 compose文件")]),s._v(" "),a("h3",{attrs:{id:"compose文件结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compose文件结构"}},[s._v("#")]),s._v(" compose文件结构")]),s._v(" "),a("p",[a("code",[s._v("docker-compose.yml")]),s._v("通常需要包含以下几个顶级元素：")]),s._v(" "),a("p",[a("code",[s._v("version")]),s._v(" 已弃用，早期版本需要此元素。")]),s._v(" "),a("p",[a("code",[s._v("services")]),s._v("必要元素，定义一个或多个容器的运行参数")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("services")]),s._v("中可以通过以下元素定义容器的运行参数")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("image")]),s._v(" 容器 镜像")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("ports")]),s._v("端口映射")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("environment")]),s._v("环境变量")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("networks")]),s._v("容器使用的网络")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("volumes")]),s._v("容器挂载的存储卷")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("command")]),s._v("容器启动时执行的命令")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("depends_on")]),s._v("定义启动顺序")])]),s._v(" "),a("li",[a("p",[s._v("复数形式（例如"),a("code",[s._v("ports")]),s._v(","),a("code",[s._v("networks")]),s._v(","),a("code",[s._v("volumes")]),s._v(","),a("code",[s._v("depends_on")]),s._v("）参数需要传入列表")])])]),s._v(" "),a("p",[a("code",[s._v("networks")]),s._v("创建自定义网络")]),s._v(" "),a("p",[a("code",[s._v("volumes")]),s._v(" 创建存储卷")]),s._v(" "),a("h3",{attrs:{id:"yaml语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yaml语法"}},[s._v("#")]),s._v(" YAML语法")]),s._v(" "),a("ul",[a("li",[s._v("缩进代表上下级关系")]),s._v(" "),a("li",[s._v("缩进时不允许使用Tab键，只允许使用空格")]),s._v(" "),a("li",[a("code",[s._v(":")]),s._v(" 键值对，后面必须有空格")]),s._v(" "),a("li",[a("code",[s._v("-")]),s._v("列表，后面必须有空格")]),s._v(" "),a("li",[a("code",[s._v("[ ]")]),s._v("数组")]),s._v(" "),a("li",[a("code",[s._v("#")]),s._v("注释")]),s._v(" "),a("li",[a("code",[s._v("{key:value,k1:v1}")]),s._v("map")]),s._v(" "),a("li",[a("code",[s._v("|")]),s._v(" 多行文本块")])]),s._v(" "),a("p",[s._v("如果一个文件中包含多个文档")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("---")]),s._v("表示一个文档的开始")])]),s._v(" "),a("h3",{attrs:{id:"vscode-remote-ssh插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vscode-remote-ssh插件"}},[s._v("#")]),s._v(" VSCode Remote SSH插件")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("背景")]),s._v(" "),a("p",[s._v("YAML格式文件直接在Linux中使用VI或VIM编辑不方便。使用VSCode Remote SSH 连接远程服务器编写yaml文件。")])]),s._v(" "),a("li",[a("p",[s._v("Remote SSH插件简介")]),s._v(" "),a("p",[s._v("Remote-SSH是一个VSCode的插件，Remote-SSH可以让你使用任何带有SSH服务的远端机器作为你的开发环境。这可以大大简化各种情况下的开发和故障排除。使用了Remote-SSH插件之后，你可以：")]),s._v(" "),a("ul",[a("li",[s._v("在您部署的同一操作系统上进行开发，或者使用比本地计算机更大、更快或更专业的硬件。")]),s._v(" "),a("li",[s._v("在不同的远程开发环境之间快速切换，并安全地进行更新，而无需担心影响本地计算机。")]),s._v(" "),a("li",[s._v("从多台计算机或多个位置访问现有开发环境。")]),s._v(" "),a("li",[s._v("调试在其他地方（如客户站点或云中）运行的应用程序。")])])]),s._v(" "),a("li",[a("p",[s._v("插件安装")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("插件市场安装")]),s._v(" "),a("p",[s._v('首先安装VSCode，然后在扩展中搜索"Remote"，安装搜索到的"Remote-SSH"和"Remote-Containers"，"Remote-SSH: Editing Configuration"插件会在安装"Remote-SSH"插件时自动')])]),s._v(" "),a("li",[a("p",[s._v("确保远程SSH已开")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以检查22端口是否被监听")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsof -i:22")]),s._v("\nCOMMAND   PID "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("   FD   TYPE DEVICE SIZE/OFF NODE NAME\nsshd     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1067")]),s._v(" root    3u  IPv4  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29703")]),s._v("      0t0  TCP *:ssh "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("LISTEN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsshd     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1067")]),s._v(" root    4u  IPv6  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29705")]),s._v("      0t0  TCP *:ssh "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("LISTEN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsshd     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3887")]),s._v(" root    3u  IPv4  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41472")]),s._v("      0t0  TCP gitlab:ssh-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.1:51514 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ESTABLISHED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsshd    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("95766")]),s._v(" root    3u  IPv4 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("571046")]),s._v("      0t0  TCP gitlab:ssh-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.1:65307 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ESTABLISHED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者直接查看SSH 服务状态")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status sshd")]),s._v("\n● sshd.service - OpenSSH server daemon\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/sshd.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Mon "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v("-08-07 08:31:26 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 8h ago\n     Docs: man:sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n           man:sshd_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1067")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    Tasks: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n   Memory: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".1M\n   CGroup: /system.slice/sshd.service\n           └─1067 /usr/sbin/sshd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-D")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("配置免密登录")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.将本地生成的公钥重写到 authorized_keys文件中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat id_rsa.pub > ~/.ssh/authorized_keys")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.在 vscode弹出的配置的文件中填写 ip ,用户名,私钥")]),s._v("\nHost "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.106\n  HostName "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.106\n  User root\n  IdentityFile C:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(".ssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("id_rsa\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])])])])]),s._v(" "),a("h3",{attrs:{id:"编排自己的项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编排自己的项目"}},[s._v("#")]),s._v(" 编排自己的项目")]),s._v(" "),a("p",[s._v("编排上一章部署的若依项目。")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("/home/docker-compose/")]),s._v("目录下创建"),a("code",[s._v("docker-compose-ry.yml")]),s._v(" 文件，已手动指定compose文件的方式启动容器，执行命令启动:"),a("code",[s._v("docker compose -f docker-compose-ry.yml up -d")])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ruoyi-app")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  docker run --name ruoyi-app      \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             -p 8080:8080        \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             --network ruoyi-net      \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             -v /home/app/ruoyi-admin.jar:/usr/local/src/ruoyi-admin.jar   \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             -d openjdk:8u342-jre    \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             java -jar /usr/local/src/ruoyi-admin.jar")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" openjdk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8u342"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("jre\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 8086"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ruoyi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("net\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /home/app/ruoyi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("admin.jar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/usr/local/src/ruoyi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("admin.jar\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-jar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/src/ruoyi-admin.jar"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("healthcheck")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMD"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"curl"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-f"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://localhost:8080"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10s\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("timeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 5s\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("retries")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("start_period")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10s\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ruoyi-db")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("condition")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" service_healthy\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ruoyi-db")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  docker run --name ruoyi-db -p 3303:3306 \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             --network ruoyi-net        \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             -v ruoyi-data:/var/lib/mysql  \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             -v /home/app/sql:/docker-entrypoint-initdb.d   \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             -e MYSQL_DATABASE=ry         \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             -e MYSQL_ROOT_PASSWORD=123456    \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             -d mysql:5.7      \\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci --skip-character-set-client-handshake")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" MYSQL_DATABASE=ry\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" MYSQL_ROOT_PASSWORD=123456\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ruoyi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/lib/mysql\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /home/app/sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("entrypoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("initdb.d\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ruoyi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("net\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--character-set-server=utf8mb4"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--collation-server=utf8mb4_unicode_ci"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--skip-character-set-client-handshake"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# healthcheck健康检查")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("healthcheck")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行检查命令 mysqladmin ping -h localhost -u root -p$$MYSQL_ROOT_PASSWORD")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMD"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mysqladmin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ping'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-h'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-u'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-p$$MYSQL_ROOT_PASSWORD'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 健康检查的间隔时间 设置为10s")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10s\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 每次健康检查的超时时间。如果健康检查命令在超时时间内没有返回结果，则认为检查失败。在这个例子中，设置为 5 秒。")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("timeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 5s\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在健康检查失败后的重试次数。如果健康检查失败，Docker 将尝试重新运行健康检查命令的次数。在这个例子中，设置为 5 次。")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("retries")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器启动后的等待时间，在这段时间内不会进行健康检查。这是为了避免容器刚启动时就进行健康检查，因为容器可能需要一些时间来完成启动过程。在这个例子中，设置为 10 秒。")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("start_period")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10s\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ruoyi-data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ruoyi-net")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br")])]),a("h3",{attrs:{id:"容器启动顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器启动顺序"}},[s._v("#")]),s._v(" 容器启动顺序")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("depends_on")])]),s._v(" "),a("p",[s._v("在 Docker Compose 中，"),a("code",[s._v("depends_on")]),s._v(" 是一个用于定义服务之间依赖关系的关键字。它允许您指定一个或多个服务依赖于其他服务的启动和运行。使用 "),a("code",[s._v("depends_on")]),s._v(" 关键字，您可以确保在启动服务时，所依赖的服务已经启动并可用。这对于需要等待其他服务准备就绪后再启动的场景非常有用，例如在应用程序容器依赖于数据库容器时。")]),s._v(" "),a("p",[s._v("请注意以下几点：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("depends_on")]),s._v(" 并不会等待依赖的服务完全可用，它只会等待依赖的服务启动。因此，在某些情况下，即使依赖的服务已经启动，也不能保证它已经完全可用。")]),s._v(" "),a("li",[s._v("在 Docker Compose v3 版本及以上，"),a("code",[s._v("depends_on")]),s._v(" 不会强制等待依赖的服务启动完成。如果您需要确保服务完全可用后再启动依赖它的服务，可以结合使用健康检查来实现。")]),s._v(" "),a("li",[s._v("在 Docker Compose 中，服务之间的依赖关系是在启动时进行检查的，而不是在运行时。这意味着如果依赖的服务在启动后发生故障，依赖它的服务可能仍然会启动，而不会自动停止。")])]),s._v(" "),a("p",[s._v("总而言之，"),a("code",[s._v("depends_on")]),s._v(" 是 Docker Compose 中用于定义服务依赖关系的关键字，它可以确保在启动服务时，所依赖的服务已经启动。但要注意它的限制和行为，以及在需要等待服务完全可用时，可以结合使用健康检查来实现。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("healthcheck")])]),s._v(" "),a("p",[s._v("健康检查用于确定容器是否正常运行，并根据检查结果自动处理容器的状态。在健康检查的 "),a("code",[s._v("test")]),s._v(" 字段中，"),a("code",[s._v("CMD")]),s._v(" 是一个关键字，用于指定要执行的命令。它是一个数组，包含了要运行的命令及其参数。")]),s._v(" "),a("p",[s._v("在上个例子中，"),a("code",[s._v("CMD")]),s._v(" 的值为 "),a("code",[s._v('["mysqladmin", "ping", "-h", "localhost", "-u", "root", "-p$$MYSQL_ROOT_PASSWORD"]')]),s._v("，它指定了要执行的命令及其参数。具体解释如下：")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("mysqladmin")]),s._v("：指定要执行的命令是 "),a("code",[s._v("mysqladmin")]),s._v("，它是 MySQL 数据库管理工具。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("ping")]),s._v("："),a("code",[s._v("mysqladmin")]),s._v(" 命令的参数之一，表示执行 "),a("code",[s._v("ping")]),s._v(" 操作，用于检查 MySQL 服务器的可用性。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-h localhost")]),s._v("："),a("code",[s._v("mysqladmin")]),s._v(" 命令的参数，指定了 MySQL 服务器的主机名为 localhost。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-u root")]),s._v("："),a("code",[s._v("mysqladmin")]),s._v(" 命令的参数，指定了要使用的用户名为 root。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-p$$MYSQL_ROOT_PASSWORD")]),s._v("："),a("code",[s._v("mysqladmin")]),s._v(" 命令的参数，指定了要使用的密码。"),a("code",[s._v("$$MYSQL_ROOT_PASSWORD")]),s._v(" 是一个环境变量的引用，表示要使用的密码值存储在名为 "),a("code",[s._v("MYSQL_ROOT_PASSWORD")]),s._v(" 的环境变量中。")])])]),s._v(" "),a("p",[s._v("因此，整个 "),a("code",[s._v("test")]),s._v(" 字段指定了在健康检查中执行的命令是 "),a("code",[s._v("mysqladmin ping -h localhost -u root -p$$MYSQL_ROOT_PASSWORD")]),s._v("，它会检查 MySQL 服务器是否可用。")])]),s._v(" "),a("li",[a("p",[s._v("如何判断容器是否支持健康检查")]),s._v(" "),a("p",[s._v("要确定容器是否支持健康检查，可以查看容器镜像的文档或元数据，以确定是否包含有关健康检查的信息。以下是几种确定容器是否支持健康检查的方法：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("查看容器镜像的文档：容器镜像通常会提供相应的文档，其中包含有关容器的详细信息，包括是否支持健康检查以及如何配置和使用健康检查功能。")])]),s._v(" "),a("li",[a("p",[s._v("查看容器镜像的元数据：使用 Docker 命令 "),a("code",[s._v("docker inspect <image>")]),s._v(" 查看容器镜像的元数据。在返回的 JSON 数据中，可以搜索与健康检查相关的字段，例如 "),a("code",[s._v('"Healthcheck"')]),s._v(" 字段。如果该字段存在并包含有关健康检查的信息，则表示该容器镜像支持健康检查。")])]),s._v(" "),a("li",[a("p",[s._v("检查容器镜像的 Dockerfile：如果您有容器镜像的 Dockerfile 文件，可以查看其中是否包含有关健康检查的相关指令，例如 "),a("code",[s._v("HEALTHCHECK")]),s._v("。这个指令用于定义容器的健康检查命令和参数。")])])]),s._v(" "),a("p",[s._v("请注意，支持健康检查的容器镜像可能会有不同的实现方式和配置选项。因此，最好参考容器镜像的官方文档或相关资源，以了解如何正确配置和使用健康检查功能。")])])]),s._v(" "),a("h3",{attrs:{id:"参考资料-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料-2"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.docker.com/compose/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网Docker Compose"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.runoob.com/docker/docker-compose.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Compose菜鸟教程"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"_9-docker-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-docker-file"}},[s._v("#")]),s._v(" 9.docker file")]),s._v(" "),a("h3",{attrs:{id:"docker-file概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-file概念"}},[s._v("#")]),s._v(" docker file概念")]),s._v(" "),a("p",[s._v("Dockerfile是自动构建docker镜像的配置文件，将镜像构建过程通过指令的方式定义在Dockerfile中。配合"),a("code",[s._v("docker build")]),s._v("命令行可以实现自动化的Docker镜像的构建。")]),s._v(" "),a("h3",{attrs:{id:"docke-file-编写规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docke-file-编写规范"}},[s._v("#")]),s._v(" docke file 编写规范")]),s._v(" "),a("ul",[a("li",[s._v("每条指令（每行开头关键字）都必须是大写字母")]),s._v(" "),a("li",[s._v("执行顺序是按照编写顺序从上到下")]),s._v(" "),a("li",[s._v("# 表示注释")])]),s._v(" "),a("h3",{attrs:{id:"dockerfile指令详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile指令详解"}},[s._v("#")]),s._v(" Dockerfile指令详解")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("FROM")]),s._v(" "),a("p",[s._v("镜像从那里来")])]),s._v(" "),a("li",[a("p",[s._v("MAINTAINER")]),s._v(" "),a("p",[s._v("镜像维护者信息")])]),s._v(" "),a("li",[a("p",[s._v("RUN")]),s._v(" "),a("p",[s._v("构建镜像执行的命令，每一次RUN都会构建一层")])]),s._v(" "),a("li",[a("p",[s._v("CMD")]),s._v(" "),a("p",[s._v("容器启动的命令，如果有多个则以最后一个为准，也可以为ENTRYPOINT提供参数")])]),s._v(" "),a("li",[a("p",[s._v("VOLUME")]),s._v(" "),a("p",[s._v("定义数据卷，如果没有定义则使用默认")])]),s._v(" "),a("li",[a("p",[s._v("USER")]),s._v(" "),a("p",[s._v("指定后续执行的用户组和用户")])]),s._v(" "),a("li",[a("p",[s._v("WORKDIR")]),s._v(" "),a("p",[s._v("切换当前执行的工作目录")])]),s._v(" "),a("li",[a("p",[s._v("HEALTHCHECH")]),s._v(" "),a("p",[s._v("健康检测指令")])]),s._v(" "),a("li",[a("p",[s._v("ARG")]),s._v(" "),a("p",[s._v("变量属性值，但不在容器内部起作用")])]),s._v(" "),a("li",[a("p",[s._v("EXPOSE")]),s._v(" "),a("p",[s._v("暴露容器端口")])]),s._v(" "),a("li",[a("p",[s._v("ENV")]),s._v(" "),a("p",[s._v("变量属性值，容器内部也会起作用")])]),s._v(" "),a("li",[a("p",[s._v("ADD")]),s._v(" "),a("p",[s._v("添加文件，如果是压缩文件也解压")])]),s._v(" "),a("li",[a("p",[s._v("COPY")]),s._v(" "),a("p",[s._v("复制文件或目录到镜像中，格式 "),a("code",[s._v("COPY source destination")]),s._v(" source 代表宿主机 destination代表容器")])]),s._v(" "),a("li",[a("p",[s._v("ENTRYPOINT")]),s._v(" "),a("p",[s._v("容器进入时执行的命令")])])]),s._v(" "),a("h3",{attrs:{id:"制作自己的镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#制作自己的镜像"}},[s._v("#")]),s._v(" 制作自己的镜像")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("编写Dockerfile")]),s._v(" "),a("p",[s._v("使用"),a("code",[s._v("ruoyi-admin.jar")]),s._v(",在ruoyi-admin目录下编写Dockerfile")]),s._v(" "),a("p",[s._v("目录结构")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@gitlab app]# ll\ntotal 74004\n-rw-r--r--. 1 root root      113 Aug  4 16:02 Dockerfile\n-rw-r--r--. 1 root root 75774628 Aug  4 09:21 ruoyi-admin.jar\ndrwxr-xr-x. 2 root root       82 Aug  4 09:47 sql\n[root@gitlab app]# pwd\n/home/app\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("Dockerfile文件内容")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('FROM openjdk:8u342-jre\nWORKDIR /app\nCOPY ./ruoyi-admin.jar .\nCMD [ "java", "-jar", "ruoyi-admin.jar" ]\nEXPOSE 80\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"dockfile中涉及的指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockfile中涉及的指令"}},[s._v("#")]),s._v(" Dockfile中涉及的指令")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("构建打包命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Dockerfile 在WORKDIR目录下，如上一节制作自己镜像举例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Dockerfile 在 /home/dockerfile 目录下 ，使用 -f指定Dockerfile 文件，注意 /home/app/为构建上下文路径，必须要填")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /home/dockerfile/Dockerfile  /home/app/ "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" ruoyi-app2:4.7.6\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -t 参数指定image 的name,tag")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" ruoyi-app-1:4.7.5 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("设置镜像的标签")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag 79d007b05ff6 ruoyi-app:4.7.4-jar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("执行 "),a("code",[s._v("docker build .")]),s._v(" 打包的镜像默认是没有 name 和 tag 的可以使用 "),a("code",[s._v("docker tag")]),s._v("设置镜像的标签。")])])])]),s._v(" "),a("h3",{attrs:{id:"image镜像和layer层"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#image镜像和layer层"}},[s._v("#")]),s._v(" image镜像和layer层")]),s._v(" "),a("p",[s._v("在Docker中，镜像（Image）和层（Layer）是两个相关但不同的概念。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("镜像")]),s._v(" "),a("p",[s._v("镜像是一个只读的文件系统，它包含了运行一个容器所需的所有文件和配置。镜像可以看作是一个容器的模板或快照，可以用来创建和运行多个相同配置的容器实例。")])]),s._v(" "),a("li",[a("p",[s._v("层(Layer)")]),s._v(" "),a("p",[s._v("层是构成镜像的基本组成部分。每个镜像由一系列层组成，每个层都包含了对文件系统的一组更改。每个层都是只读的，并且可以被其他层共享和重用。这种层次结构的设计使得镜像可以非常高效地进行存储和传输，因为只有发生更改的层才需要被添加或更新。当你构建一个镜像时，每个指令（如 "),a("code",[s._v("FROM")]),s._v("、"),a("code",[s._v("COPY")]),s._v("、"),a("code",[s._v("RUN")]),s._v(" 等）都会创建一个新的层。这些指令在 Dockerfile 中按顺序执行，每个指令都会在前一个层的基础上进行更改，并生成一个新的层。每个层都有一个唯一的标识符，通常是一个 SHA256 哈希值。这个标识符用于检查和比较层的内容，以确保镜像的完整性和一致性。")]),s._v(" "),a("blockquote",[a("p",[s._v("当你使用 "),a("code",[s._v("docker build")]),s._v(" 命令构建镜像时，Docker 构建引擎会根据 Dockerfile 中的指令逐步执行，并在每个指令的基础上创建新的层。这些层将组合成最终的镜像。在构建过程中，每个层都可以被缓存和重用。这意味着如果你对 Dockerfile 进行了修改，但只有部分指令发生了变化，那么只有受到影响的层及其后续层才会重新构建，而之前的层将从缓存中获取。这种层的机制使得镜像的构建和分发变得高效和可重复。它还允许你创建基于现有镜像的定制镜像，只需在现有镜像的基础上添加或修改一些层即可，而无需重新构建整个镜像。")])])])]),s._v(" "),a("h3",{attrs:{id:"多阶段构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多阶段构建"}},[s._v("#")]),s._v(" 多阶段构建")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("概念")]),s._v(" "),a("p",[s._v("Dockerfile 多阶段构建是一种在 Dockerfile 中使用多个构建阶段来构建镜像的方法。它可以帮助减小最终镜像的大小，同时保持构建过程的清晰性和可维护性。")]),s._v(" "),a("p",[s._v("多阶段构建的基本思想是在一个 Dockerfile 中定义多个构建阶段（stage），每个阶段都可以有自己的基础镜像和指令。每个阶段都可以生成一个中间镜像，但只有最后一个阶段的镜像会被保留为最终的镜像。")])]),s._v(" "),a("li",[a("p",[s._v("实例")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("FROM maven AS build\nWORKDIR /source\nCOPY "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nRUN mvn package\n\nFROM  openjdk:8u342-jre\nWORKDIR /app\nCOPY "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--from")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("build /source/ruoyi-admin/target/ruoyi-admin.jar "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\nENTRYPOINT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-jar"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ruoyi-admin.jar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("blockquote",[a("p",[s._v("使用 Maven来构建应用，在最终的image中不需要包含maven。我们可以使用多阶段构建，每一个阶段从"),a("code",[s._v("FROM")]),s._v("开始，最终的image只会从最后一个阶段构建，不会包含前面阶段产生的层，因此可以减少镜像体积。")])])])]),s._v(" "),a("h3",{attrs:{id:"dockerfile参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile参考资料"}},[s._v("#")]),s._v(" Dockerfile参考资料")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("官网")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Dockerfile reference"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[s._v("博客")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://zimug.blog.csdn.net/article/details/124441548",target:"_blank",rel:"noopener noreferrer"}},[s._v("逐行解析Nginx镜像Dockerfile(学习经典)"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://zimug.blog.csdn.net/article/details/124906253",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用Dockerfile构建镜像"),a("OutboundLink")],1)])])]),s._v(" "),a("h2",{attrs:{id:"_10-私有仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-私有仓库"}},[s._v("#")]),s._v(" 10. 私有仓库")]),s._v(" "),a("h3",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[s._v("#")]),s._v(" 背景")]),s._v(" "),a("p",[s._v("我们可以使用"),a("code",[s._v("docker push")]),s._v("将自己的image推送到docker hub中进行共享，但是在实际工作中，很多公司的代码不能上传到公开的仓库中，因此我们可以创建自己的镜像仓库。")]),s._v(" "),a("h3",{attrs:{id:"docker-registry"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-registry"}},[s._v("#")]),s._v(" docker registry")]),s._v(" "),a("p",[s._v("docker 官网提供了一个docker registry的私有仓库项目，可以方便的通过docker部署。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署私有仓库 docker registry")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v(":5000 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),s._v(" always "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" registry registry:2\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 给一个现有的本地镜像 "ruoyi-java:4.7.4" 打标签，以便将其推送到本地的 Docker Registry。')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image tag ruoyi-java:4.7.4 localhost:5000/ruoyi-java:4.7.4\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将本地的镜像推送到指定的 Docker Registry。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push localhost:5000/ruoyi-java:4.7.4\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从指定的 Docker Registry 拉取镜像到本地。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull localhost:5000/ruoyi-java:4.7.4\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("为了避免推送报错，可以修改"),a("code",[s._v("/etc/docker/daemon.json")]),s._v("，加入")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"insecure-registries"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.35.106:5000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这是因为"),a("code",[s._v("docker push")]),s._v("默认使用"),a("code",[s._v("HTTPS")]),s._v("协议，而服务端的"),a("code",[s._v("registry")]),s._v("仓库使用的是"),a("code",[s._v("HTTP")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"harbor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#harbor"}},[s._v("#")]),s._v(" harbor")]),s._v(" "),a("p",[s._v("habor是一个功能更强大镜像仓库，它具有完整的权限控制和Web界面，更符合我们的实际工作场景。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" harbor\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载安装包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com/bitnami/containers/archive/main.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压安装包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-xzvf")]),s._v(" containers-main.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入安装目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" containers-main/bitnami/harbor-portal\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行docker compose命令启动容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" compose up "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("浏览器访问："),a("a",{attrs:{href:"http://192.168.35.106/harbor/projects",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://192.168.35.106"),a("OutboundLink")],1),s._v("，默认用户名/密码："),a("code",[s._v("admin/bitnami")])]),s._v(" "),a("h3",{attrs:{id:"镜像的保存和加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像的保存和加载"}},[s._v("#")]),s._v(" 镜像的保存和加载")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("背景")]),s._v(" "),a("p",[s._v("当我们处于离线状态，比如在很多内网上不能访问互联网，这时候不能通过镜像仓库的方式共享image，我们可以使用导出和导入功能，手动拷贝镜像。")])]),s._v(" "),a("li",[a("p",[s._v("常用命令")]),s._v(" "),a("p",[a("code",[s._v("docker save")])]),s._v(" "),a("p",[s._v("会包含所有层，以及所有标签 + 版本信息。")]),s._v(" "),a("p",[a("code",[s._v("docker save alpine:3.15 > alpine-3.15.tar")])]),s._v(" "),a("p",[s._v("保存image")]),s._v(" "),a("p",[a("code",[s._v("docker rmi alpine:3.15")])]),s._v(" "),a("p",[s._v("删除本地image")]),s._v(" "),a("p",[a("code",[s._v("docker load < alpine-3.15.tar")])]),s._v(" "),a("p",[s._v("加载image")])]),s._v(" "),a("li",[a("p",[s._v("注意事项")]),s._v(" "),a("p",[s._v("不要跟export和import命令混淆")]),s._v(" "),a("p",[a("code",[s._v("docker save/load IMAGE")]),s._v(" save和load操作的是镜像")]),s._v(" "),a("p",[a("code",[s._v("docker export/import CONTAINER")]),s._v("export和import操作对象是容器")]),s._v(" "),a("p",[s._v("image包含多个层，每一层都不可变，save保存的信息包含每个层和所有标签 + 版本信息。")]),s._v(" "),a("p",[s._v("容器运行的时候会创建一个可写入的容器层，所有的更改都写入容器层，export导出的只有容器层，不包含父层和标签信息。")])])]),s._v(" "),a("h3",{attrs:{id:"一些设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一些设置"}},[s._v("#")]),s._v(" 一些设置")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("设置hosts")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab harbor-portal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /etc/hosts")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.106 reg.mydomain.com\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[a("code",[s._v("reg.mydomain.com")]),s._v("是这个镜像自带的域名。")])])]),s._v(" "),a("li",[a("p",[s._v("设置 insecure")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 在ExecStart后面加入--insecure-registry=192.168.35.106\n[root@gitlab harbor-portal]# vi /usr/lib/systemd/system/docker.service\nExecStart=/usr/bin/dockerd --insecure-registry=192.168.35.106\n# 改完需要重启docker 服务\nsystemctl daemon-reload\nsystemctl reload docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("blockquote",[a("p",[s._v("在 Docker 服务的 systemd 配置文件 "),a("code",[s._v("/usr/lib/systemd/system/docker.service")]),s._v(" 中，通过设置 "),a("code",[s._v("--insecure-registry")]),s._v(" 参数为 "),a("code",[s._v("192.168.35.106")]),s._v("，是为了将该 IP 地址的仓库（Registry）标记为不安全的，即 Docker 客户端可以与该仓库建立非 HTTPS 的连接。")]),s._v(" "),a("p",[s._v("默认情况下，Docker 客户端只允许与使用 HTTPS 协议的仓库进行通信，以确保数据传输的安全性。然而，有些仓库可能没有配置 HTTPS，而是使用 HTTP 进行通信。为了允许 Docker 客户端与这类不安全的仓库进行通信，可以使用 "),a("code",[s._v("--insecure-registry")]),s._v(" 参数来标记这些仓库为不安全。")]),s._v(" "),a("p",[s._v("在你提供的配置中，"),a("code",[s._v("--insecure-registry=192.168.35.106")]),s._v(" 表示将 "),a("code",[s._v("192.168.35.106")]),s._v(" 标记为不安全的仓库，允许 Docker 客户端与其建立非 HTTPS 的连接。这样，Docker 客户端就可以与该仓库进行正常的推送（push）和拉取（pull）操作。")]),s._v(" "),a("p",[s._v("请注意，使用不安全的仓库可能存在安全风险，因为数据传输未加密。建议在生产环境中使用安全的 HTTPS 仓库，以确保数据的机密性和完整性。")])])]),s._v(" "),a("li",[a("p",[s._v("设置优先私有仓库拉取")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增加私有仓库地址")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab harbor-portal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/docker/daemon.json ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://192.168.35.106"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://registry.docker-cn.com"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://hub-mirror.c.163.com"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://fsp2sfpr.mirror.aliyuncs.com/"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("推送设置")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.给镜像打标签")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将本地的镜像标记为你的私有仓库的地址和相应的标签")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab harbor-portal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker tag ruoyi-app2:4.7.6 192.168.35.106/harbor/ruoyi-app:4.7.9")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.登录docker 私有仓库")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 docker login 命令登录到你的私有仓库。这将要求你提供私有仓库的地址和认证凭据。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab harbor-portal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker login 192.168.35.106")]),s._v("\nAuthenticating with existing credentials"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nWARNING"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" Your password will be stored unencrypted "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /root/.docker/config.json.\nConfigure a credential helper to remove this warning. See\nhttps://docs.docker.com/engine/reference/commandline/login/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#credentials-store")]),s._v("\n\nLogin Succeeded\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.推送到远端私有仓库")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 docker push 命令将标记的镜像推送到远程私有仓库。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab harbor-portal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker push 192.168.35.106/harbor/ruoyi-app:4.7.9")]),s._v("\nThe push refers to repository "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.106/harbor/ruoyi-app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n999b7a88f264: Mounted from harbor/ruoyi-java \nac1c3fe6b031: Mounted from harbor/ruoyi-java \n1aaddf64804f: Mounted from harbor/ruoyi-java \n990c5138f5d1: Mounted from harbor/ruoyi-java \n5c384ea5f752: Mounted from harbor/ruoyi-java \n293d5db30c9f: Mounted from harbor/ruoyi-java \n03127cdb479b: Mounted from harbor/ruoyi-java \n9c742cd6c7a5: Mounted from harbor/ruoyi-java \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.7")]),s._v(".9: digest: sha256:c6b234b64a628296eba42f45489c2dc5673a724e7a8e12cd3e8d64ab025dc655 size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2001")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.从私有仓库拉取镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 docker pull 命令从私有仓库拉取镜像。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@gitlab harbor-portal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull 192.168.35.106/harbor/ruoyi-app:4.7.9")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.7")]),s._v(".9: Pulling from harbor/ruoyi-app\nDigest: sha256:c6b234b64a628296eba42f45489c2dc5673a724e7a8e12cd3e8d64ab025dc655\nStatus: Downloaded newer image "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.106/harbor/ruoyi-app:4.7.9\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.106/harbor/ruoyi-app:4.7.9\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])]),a("blockquote",[a("p",[a("code",[s._v("docker tag")]),s._v(" 是 "),a("code",[s._v("docker image tag")]),s._v(" 的缩写显示，官方推荐使用 "),a("code",[s._v("docker image tag")]),s._v(",两个命令的使用效果是等效的。使用这两个命令，你可以给一个已有的 Docker 镜像打上新的标签，使其具有多个标签。这在镜像管理和版本控制中非常有用。")])])])]),s._v(" "),a("h2",{attrs:{id:"_11-windows-安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-windows-安装docker"}},[s._v("#")]),s._v(" 11. windows 安装docker")]),s._v(" "),a("h3",{attrs:{id:"参考资料-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料-3"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docker.easydoc.net/doc/81170005/cCewZWoN/lTKfePfP",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker 简介和安装"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"_12-portainer安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-portainer安装"}},[s._v("#")]),s._v(" 12. portainer安装")]),s._v(" "),a("h3",{attrs:{id:"概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[s._v("#")]),s._v(" 概念")]),s._v(" "),a("p",[s._v("Portainer是一个可视化的Docker管理系统，功能十分全面，提供状态显示面板、应用模板快速部署、容器镜像、网络、数据卷的基本操作、事件日志显示、容器控制台操作、登录用户管理和控制等功能。")]),s._v(" "),a("h3",{attrs:{id:"部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[s._v("#")]),s._v(" 部署")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume create portainer_data\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":8000 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),s._v(":9000 \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /var/run/docker.sock:/var/run/docker.sock \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" portainer_data:/data \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" portainer portainer/portainer-ce\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("打开浏览器访问 http://192.168.35.106:9000,按提示创建用户登录。")]),s._v(" "),a("h3",{attrs:{id:"容器重启策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器重启策略"}},[s._v("#")]),s._v(" 容器重启策略")]),s._v(" "),a("p",[s._v("容器的重启策略。由"),a("code",[s._v("--restart")]),s._v("参数决定。有以下选项")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("--restart=no")])]),s._v(" "),a("p",[s._v("默认为no，不会自动重启容器。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("--restart=always")])]),s._v(" "),a("p",[s._v("当容器停止运行时，总是重启容器。当我们重启docker进程时，也会自动重启容器。如果我们使用"),a("code",[s._v("docker stop")]),s._v("停止容器时，则不会自动重启容器。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("--restart=on-failure")])]),s._v(" "),a("p",[s._v("在容器非正常退出时（退出状态非0），才会重启容器")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("--restart=on-failure:10")])]),s._v(" "),a("p",[s._v("仅当容器以异常状态退出时，才重启容器。若重启不成功，最多尝试重启 10次。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("--restart=unless-stopped")])]),s._v(" "),a("p",[s._v("当我们重启docker时，若这个容器已经处停止状态，则不进行自动重启。")])])]),s._v(" "),a("h2",{attrs:{id:"_13-docker-安装常见数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_13-docker-安装常见数据库"}},[s._v("#")]),s._v(" 13.docker 安装常见数据库")]),s._v(" "),a("h3",{attrs:{id:"docker-安装oracle11g"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装oracle11g"}},[s._v("#")]),s._v(" docker 安装oracle11g")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("创建数据共享目录")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /oracle11g/oradata "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" /oracle11g/oradata\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("拉取镜像")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker pull registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("创建容器")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run -d --restart=always --privileged=true -p 1522:1522 -p 5501:5501 --name oracle11g -v /oracle11g/oradata:/oracle11g/oradata registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("注意这里的暴露端口为1522,与oralce默认监听端口1521不一致，需要进入容器"),a("a",{attrs:{href:"https://my.oschina.net/u/4362820/blog/3574754",target:"_blank",rel:"noopener noreferrer"}},[s._v("修改oracle默认监听端口"),a("OutboundLink")],1),s._v(",注意在容器内修改端口，只需要更改端口"),a("code",[s._v("PORT")]),s._v(",不需要更改"),a("code",[s._v("HOST")])])])]),s._v(" "),a("li",[a("p",[s._v("查看oracle11g容器是否创建成功")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker ps -a\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("进入镜像镜像进行配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker exec -it oracle11g /bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("切换到root下进行配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("su root （密码：helowin）\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("编辑profile文件配置ORACLE环境变量")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vi /etc/profile\n# 添加：\nexport ORACLE_HOME=/home/oracle/app/oracle/product/11.2.0/dbhome_2\nexport ORACLE_SID=helowin\nexport PATH=$ORACLE_HOME/bin:$PATH\n# 环境生效\nsource /etc/profile\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("创建软连接")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ln -s $ORACLE_HOME/bin/sqlplus /usr/bin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("切换到oracle 用户")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("su - oracle\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("登录sqlplus并修改sys、system用户密码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sqlplus /nolog\nconn /as sysdba\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("修改sys、system用户密码并刷新权限")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("alter user system identified by "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nalter user sys identified by "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置密码生效策略")]),s._v("\nALTER PROFILE DEFAULT LIMIT PASSWORD_LIFE_TIME UNLIMITED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看oracle实例")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("oracle@177c1d8c514a ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ lsnrctl status\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("oracle@177c1d8c514a ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("用nacivat连接oracle数据库")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("服务名：helowin（一定要填写helowin）\n用户名：system\n密码：123456（第10步设置的密码）\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"docker-安装oracle12c"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装oracle12c"}},[s._v("#")]),s._v(" docker 安装oracle12c")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("创建数据共享目录")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir -p /home/nicemoe/oradata && chmod 777 /home/nicemoe/oradata\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("拉取镜像")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker pull registry.cn-hangzhou.aliyuncs.com/zhuyijun/oracle-12c\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("启动容器")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run -d --restart=always --privileged=true --name myoracle -p 1521:1521 -p 5500:5500 -e ORACLE_SID=ORCLCDB -e ORACLE_PDB=orclpdb1 -e ORACLE_PWD=123456 -e ORACLE_CHARACTERSET=zhs16gbk -e ORACLE_BASE=/opt/oracle -e ORACLE_HOME=/opt/oracle/product/12.2.0.1/dbhome_1 -e PATH=/opt/oracle/product/12.2.0.1/dbhome_1/bin:/opt/oracle/product/12.2.0.1/dbhome_1/OPatch/:/usr/sbin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin -v /home/nicemoe/oradata:/opt/oracle/oradata registry.cn-hangzhou.aliyuncs.com/zhuyijun/oracle-12c:latest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("修改密码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker exec  <container name> ./setPassword.sh <your password>\n例如：\ndocker exec  a5f5a90ec826 ./setPassword.sh 123456\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("blockquote",[a("p",[s._v("注意要在容器启动后在执行，不然报错。")])])]),s._v(" "),a("li",[a("p",[s._v("登录数据库")]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/docker.assets/image-20221124131751484.png",alt:"image-20221124131751484"}})])]),s._v(" "),a("li",[a("p",[s._v("参考资料")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/qq_26018075/article/details/107844316",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker安装orcale-12c"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/GeorgeChan_/article/details/124040161",target:"_blank",rel:"noopener noreferrer"}},[s._v("Oracle数据库CDB与PDB"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/lixiangss1993/article/details/121677355",target:"_blank",rel:"noopener noreferrer"}},[s._v("oracle12c19c创建用户"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/ctypyb2002/article/details/97250017",target:"_blank",rel:"noopener noreferrer"}},[s._v("jdbc连接oracle常见两种方式 OCI THIN"),a("OutboundLink")],1)])])]),s._v(" "),a("h3",{attrs:{id:"docker-安装sqlserver2017"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装sqlserver2017"}},[s._v("#")]),s._v(" docker 安装sqlserver2017")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("创建数据共享目录")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir -p /sqlserver2017/sqlserver-data && chmod 777 /sqlserver2017/sqlserver-data\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("拉取镜像")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker pull mcr.microsoft.com/mssql/server:2017-latest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("启动容器")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('docker run -e "ACCEPT_EULA=Y" -e "SA_PASSWORD=qwe20211114." -p 1433:1433 --name sqlserver2017 -d --restart=always --privileged=true -v /sqlserver2017/sqlserver-data:/sqlserver2017/sqlserver-data mcr.microsoft.com/mssql/server:2017-latest\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("注意这个SA_PASSWORD必须要是强密码，不然不通过")]),s._v(" "),a("p",[s._v("保证安装内存2G及以上")])])]),s._v(" "),a("li",[a("p",[s._v("进入容器")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# 1.进入容器\ndocker exec -it sqlserver2017 /bin/bash\n# 2.登录数据库\n/opt/mssql-tools/bin/sqlcmd -S localhost -U SA -P "qwe20211114."\n# 3.查询数据库\nselect name from sys.Databases\ngo\n# 4.创建数据库\ncreate database flinktest\ngo\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("远程连接")]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/docker.assets/image-20221124133520135.png",alt:"image-20221124133520135"}})])]),s._v(" "),a("li",[a("p",[s._v("参考资料")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/qq_19309473/article/details/121313368",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker 安装 SQL Server教程"),a("OutboundLink")],1)])])]),s._v(" "),a("h2",{attrs:{id:"_14-docker-参考教程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_14-docker-参考教程"}},[s._v("#")]),s._v(" 14. DOCKER 参考教程")]),s._v(" "),a("h3",{attrs:{id:"docker-基本管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-基本管理"}},[s._v("#")]),s._v(" Docker 基本管理")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/7168058169472581646",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker 基本管理"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"docker-容器管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-容器管理"}},[s._v("#")]),s._v(" Docker 容器管理")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/7168667291809218573",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker 容器管理 "),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"docker的网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker的网络"}},[s._v("#")]),s._v(" Docker的网络")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/7169025398628597767",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker的网络"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"docker-cgroups资源控制管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-cgroups资源控制管理"}},[s._v("#")]),s._v(" Docker Cgroups资源控制管理")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/7169433873514758180",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Cgroups资源控制管理 "),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"docker-数据管理-数据卷、容器互联"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-数据管理-数据卷、容器互联"}},[s._v("#")]),s._v(" docker 数据管理(数据卷、容器互联)")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/7170311038879924261",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker 数据管理(数据卷、容器互联) "),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"基于dockerfile创建镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于dockerfile创建镜像"}},[s._v("#")]),s._v(" 基于Dockerfile创建镜像")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/7170710426794065933",target:"_blank",rel:"noopener noreferrer"}},[s._v("基于Dockerfile创建镜像 "),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"docker-compose单机编排"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose单机编排"}},[s._v("#")]),s._v(" docker-Compose单机编排")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/7171727144400519205",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker-Compose单机编排"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"docker-harbor私有仓库部署与管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-harbor私有仓库部署与管理"}},[s._v("#")]),s._v(" docker - harbor私有仓库部署与管理")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/7172968486019268638",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker - harbor私有仓库部署与管理 "),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"docker-consul的容器服务更新与发现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-consul的容器服务更新与发现"}},[s._v("#")]),s._v(" docker consul的容器服务更新与发现")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/7173240268659884046",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker consul的容器服务更新与发现 "),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);