(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{491:function(s,a,t){"use strict";t.r(a);var n=t(2),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"第六章-flume"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第六章-flume"}},[s._v("#")]),s._v(" 第六章 Flume")]),s._v(" "),a("h2",{attrs:{id:"_6-1-概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-概念"}},[s._v("#")]),s._v(" 6.1 概念")]),s._v(" "),a("p",[s._v("Flume是一个"),a("strong",[s._v("高可用")]),s._v("，"),a("strong",[s._v("高可靠")]),s._v("，"),a("strong",[s._v("分布式")]),s._v("的海量日志采集、聚合和传输的系统，能够有效的收集、聚合、移动大量的日志数据的工具。")]),s._v(" "),a("blockquote",[a("p",[s._v("一句话 靠谱 方便的日志采集工具。")]),s._v(" "),a("p",[s._v("Flume偏向数据传输。"),a("a",{attrs:{href:"https://blog.csdn.net/weixin_40213018/article/details/120159498",target:"_blank",rel:"noopener noreferrer"}},[s._v("Flume 和 Logstash 区别"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"_6-2特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2特性"}},[s._v("#")]),s._v(" 6.2特性")]),s._v(" "),a("ul",[a("li",[s._v("简单，灵活的基于流的结构")]),s._v(" "),a("li",[s._v("具有负载均衡和故障转移机制")])]),s._v(" "),a("h2",{attrs:{id:"_6-3-应用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-应用场景"}},[s._v("#")]),s._v(" 6.3 应用场景")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("基本应用场景")]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/Hadoop%E7%94%9F%E6%80%81%E4%BD%93%E7%B3%BB.assets/image-20220822142337632.png",alt:"image-20220822142337632"}})]),s._v(" "),a("blockquote",[a("p",[s._v("WebServer：Web应用产生日志,")]),s._v(" "),a("p",[s._v("Agent：Flume代理，是一个持续传输数据的服务，数据在Agent内部传输的基本单位是Event")]),s._v(" "),a("p",[s._v("Agent是由Source、Channel、Sink这三大组件组成的，这就是Flume中的三大核心组件")]),s._v(" "),a("p",[s._v("Event是flume中处理消息的基本单元，由零个或者多个header和正文body组成。")])])]),s._v(" "),a("li",[a("p",[s._v("高级应用场景")]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/Hadoop%E7%94%9F%E6%80%81%E4%BD%93%E7%B3%BB.assets/image-20220822142358085.png",alt:"image-20220822142358085"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/Hadoop%E7%94%9F%E6%80%81%E4%BD%93%E7%B3%BB.assets/image-20220822142430710.png",alt:"image-20220822142430710"}})])])]),s._v(" "),a("h2",{attrs:{id:"_6-4-核心组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-核心组件"}},[s._v("#")]),s._v(" 6.4 核心组件")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Source")]),s._v(" "),a("p",[s._v("Source数据源，通过source组件可以指定让Flume读取哪里的数据，然后将数据传递给后面的channel。")]),s._v(" "),a("p",[s._v("常见的Source类型")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Exec Source")]),s._v(" "),a("p",[s._v("监控文件中新增的内容")])]),s._v(" "),a("li",[a("p",[s._v("NetCat TCP/UDP Source")]),s._v(" "),a("p",[s._v("采集指定端口(tcp、udp)的数据，可以读取流经端口的每一行数据")])]),s._v(" "),a("li",[a("p",[s._v("Spooling Directory Source")]),s._v(" "),a("p",[s._v("采集文件夹中新增的文件")])]),s._v(" "),a("li",[a("p",[s._v("Kafka Source")]),s._v(" "),a("p",[s._v("从Kafka消息队列中采集数据")])])])]),s._v(" "),a("li",[a("p",[s._v("Channel")]),s._v(" "),a("p",[s._v("Channel，临时存储数据的管道，")]),s._v(" "),a("p",[s._v("常见的存储数据的类型")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Memory Channel")]),s._v(" "),a("p",[s._v("优点是效率高，不涉及磁盘IO")]),s._v(" "),a("p",[s._v("缺点有两个")]),s._v(" "),a("ol",[a("li",[s._v("可能会丢数据，如果Flume的agent挂了，那么channel中的数据就丢失了。")]),s._v(" "),a("li",[s._v("内存是有限的，会存在内存不够用的情况")])])]),s._v(" "),a("li",[a("p",[s._v("File Channel")]),s._v(" "),a("p",[s._v("优点是数据不会丢失\n缺点是效率相对内存来说会有点慢，但是这个慢并没有我们想象中的那么慢，所以这个也是比较常用的一种channel。")])]),s._v(" "),a("li",[a("p",[s._v("Spillable Memory Channel")]),s._v(" "),a("p",[s._v("优点：解决了内存不够用的问题。\n缺点：还是存在数据丢失的风险")])])])]),s._v(" "),a("li",[a("p",[s._v("Sink")]),s._v(" "),a("p",[s._v("Sink负责把Channel中的数据，写入目的地。")]),s._v(" "),a("p",[s._v("常见的Sink类型")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Logger Sink")]),s._v(" "),a("p",[s._v("将数据作为日志处理，可以选择打印到控制台或者写到文件中，这个主要在测试的时候使用。")])]),s._v(" "),a("li",[a("p",[s._v("HDFS Sink")]),s._v(" "),a("p",[s._v("将数据传输到HDFS中，这个是比较常见的，主要针对离线计算的场景")])]),s._v(" "),a("li",[a("p",[s._v("Kafka Sink")]),s._v(" "),a("p",[s._v("将数据发送到kafka消息队列中，这个也是比较常见的，主要针对实时计算场景，数据不落盘，实时传输，最后使用实时计算框架直接处理。")])])])])]),s._v(" "),a("h2",{attrs:{id:"_6-5-快速上手"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-快速上手"}},[s._v("#")]),s._v(" 6.5 快速上手")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("入门案例")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("需求分析")]),s._v(" "),a("p",[s._v("Source:NetCat TCP/UDP Source")]),s._v(" "),a("p",[s._v("Channel:Memory Channel")]),s._v(" "),a("p",[s._v("Sink:Logger Sink")])]),s._v(" "),a("li",[a("p",[s._v("编写 配置文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /data/soft/apache-flume-1.9.0-bin/conf/example.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#example.conf: A single-node Flume configuration")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# a1 代表agent Flume代理，分别给source,sink,channel 命名")]),s._v("\na1.sources "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.sinks "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定source 类型为 netcat 监听端口发送来的信息")]),s._v("\na1.sources.r1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netcat\na1.sources.r1.bind "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\na1.sources.r1.port "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定 sink 类型 为 logger")]),s._v("\na1.sinks.k1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logger\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use a channel which buffers events in memory")]),s._v("\na1.channels.c1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na1.sources.r1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k1.channel "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("启动 Flume")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 apache-flume-1.9.0-bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bin/flume-ng agent --name a1 --conf conf --conf-file conf/example.conf -Dflume.root.logger=INFO,console")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("后面指定agent，表示启动一个Flume的agent代理")]),s._v(" "),a("p",[s._v("--name：指定agent的名字")]),s._v(" "),a("p",[s._v("--conf：指定flume配置文件的根目录")]),s._v(" "),a("p",[s._v("--conf-file：指定Agent对应的配置文件(包含source、channel、sink配置的文件)")]),s._v(" "),a("p",[s._v("-D：动态添加一些参数，在这里是指定了flume的日志输出级别和输出位置，INFO表示日志级别")])])]),s._v(" "),a("li",[a("p",[s._v("发送消息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# telnet 192.168.35.103 44444")]),s._v("\nTrying "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.103"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nConnected to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.103.\nEscape character is "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'^]'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nhello big data04\nOK\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("blockquote",[a("p",[a("code",[s._v("yum install -y telnet")])])])]),s._v(" "),a("li",[a("p",[s._v("控制台打印信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO - org.apache.flume.sink.LoggerSink.process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("LoggerSink.java:95"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Event: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" headers:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" body: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("68")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),s._v(" 6C 6C 6F "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("62")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("69")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("67")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("61")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("74")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("61")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v(" hello big data04 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])])]),s._v(" "),a("li",[a("p",[s._v("采集文件内容上传至HDFS")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("需求分析")]),s._v(" "),a("p",[s._v("Source:Spooling Directory Source")]),s._v(" "),a("p",[s._v("Channel:File Channel")]),s._v(" "),a("p",[s._v("Sink:HDFS Sink")])]),s._v(" "),a("li",[a("p",[s._v("设置客户端节点")]),s._v(" "),a("p",[s._v("将bigdata04设置为客户端节点以访问HDFS")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拷贝配置文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata01 soft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp -rq hadoop-3.2.0 192.168.182.103:/data/soft/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改配置文件(建议将bigdata01的配置文件直接拷贝至bigdata04)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HADOOP_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/data/soft/hadoop-3.2.0\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$HADOOP_HOME")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$HADOOP_HOME")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("blockquote",[a("p",[s._v("注意配置文件 生效 "),a("code",[s._v("source /etc/profile")])])])]),s._v(" "),a("li",[a("p",[s._v("编写配置文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat file-to-hdfs.conf ")]),s._v("\nme the components on this agent\na1.sources "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.sinks "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na1.sources.r1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" spooldir\na1.sources.r1.spoolDir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/log/studentDir\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use a channel which buffers events in memory")]),s._v("\na1.channels.c1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\na1.channels.c1.checkpointDir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/soft/apache-flume-1.9.0-bin/data/studentDir/checkpoint\na1.channels.c1.dataDirs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/soft/apache-flume-1.9.0-bin/data/studentDir/data\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na1.sinks.k1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs\na1.sinks.k1.hdfs.path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs://192.168.35.100:9000/flume/studentDir\na1.sinks.k1.hdfs.filePrefix "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" stu-\na1.sinks.k1.hdfs.fileType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DataStream\na1.sinks.k1.hdfs.writeFormat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Text\na1.sinks.k1.hdfs.rollInterval "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\na1.sinks.k1.hdfs.rollSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("134217728")]),s._v("\na1.sinks.k1.hdfs.rollCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("al.sinks.k1.hdfs.fileSuffix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .log\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na1.sources.r1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k1.channel "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("启动HADOOP集群")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata01 sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# start-all.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata01 sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pwd")]),s._v("\n/data/soft/hadoop-3.2.0/sbin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("新增文件")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("/data/log/studentDir")]),s._v("目录下新增文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 hadoop-3.2.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /data/log/studentDir/")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("36")]),s._v("\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("76")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":08 class1.dat.COMPLETED\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("76")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":13 class2.dat.COMPLETED\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":24 LOL1111.txt.COMPLETED\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":55 LOL222.dat.COMPLETED\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":27 LOL666.dat.COMPLETED\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":37 LOL9999.dat.COMPLETED\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":30 LOL999.dat.COMPLETED\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":14 LOL.dat.COMPLETED\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":45 LOLjjjjj.dat.COMPLETED\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("blockquote",[a("p",[s._v("注意 Flume 读取完的文件有"),a("code",[s._v(".COMPLETED")]),s._v("后缀")])])]),s._v(" "),a("li",[a("p",[s._v("启动Flume")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 apache-flume-1.9.0-bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bin/flume-ng agent --name a1 --conf conf --conf-file conf/file-to-hdfs.conf -Dflume.root.logger=INFO,console")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看 HDFS文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 hadoop-3.2.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bin/hdfs dfs -cat hdfs://192.168.35.100:9000/flume/studentDir/stu-.1661396200534")]),s._v("\nhello LOL"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nhello github"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("使用 nohup & 启动")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.nohup 启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 apache-flume-1.9.0-bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nohup bin/flume-ng agent --name a1 --conf conf --conf-file conf/file-to-hdfs.conf -Dflume.root.logger=INFO,console &")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.创建源文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 hadoop-3.2.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /data/log/studentDir/1111.dat")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.查看hdfs")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 hadoop-3.2.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bin/hdfs dfs -cat hdfs://192.168.35.100:9000/flume/studentDir/stu-.1661396803549")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11111")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.查看 nohup日志")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 apache-flume-1.9.0-bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat nohup.out")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭nohup")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 apache-flume-1.9.0-bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# jps -ml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2740")]),s._v(" org.apache.flume.node.Application "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" a1 --conf-file conf/file-to-hdfs.conf\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2966")]),s._v(" sun.tools.jps.Jps "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 apache-flume-1.9.0-bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kill -9 2740")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 apache-flume-1.9.0-bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# jps -ml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2976")]),s._v(" sun.tools.jps.Jps "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("+  Killed                  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" bin/flume-ng agent "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" a1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--conf")]),s._v(" conf --conf-file conf/file-to-hdfs.conf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dflume.root.logger")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INFO,console\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 apache-flume-1.9.0-bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("blockquote",[a("p",[a("code",[s._v("jps -ml")]),s._v("显示main方法所在进程的名称")])])])])]),s._v(" "),a("li",[a("p",[s._v("采集网站日志上传至HDFS")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("需求分析")]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/Hadoop%E7%94%9F%E6%80%81%E4%BD%93%E7%B3%BB.assets/image-20220825144022886.png",alt:"image-20220825144022886"}})]),s._v(" "),a("p",[s._v("bigdata02:192.168.35.101")]),s._v(" "),a("p",[s._v("bigdata03:192.168.35.102")]),s._v(" "),a("p",[s._v("bigdata04:192.168.35.103")])]),s._v(" "),a("li",[a("p",[s._v("分别安装Flume")]),s._v(" "),a("div",{staticClass:"language-SHELL line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 bigdata02 上安装 Flume")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata02 soft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -zxvf apache-flume-1.9.0-bin.tar.gz")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata02 soft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd apache-flume-1.9.0-bin/conf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata02 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mv flume-env.sh.template  flume-env.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 bigdata03 上安装Flume")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata03 soft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -zxvf apache-flume-1.9.0-bin.tar.gz")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata03 soft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd apache-flume-1.9.0-bin/conf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata03 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mv flume-env.sh.template  flume-env.sh")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("编写脚本模拟实时产生日志文件 access.log")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata02 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi generateAccessLog.sh ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 循环向文件中生成数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取当前时间戳")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("curr_time")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%s"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取当前主机名")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${name}")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${curr_time}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /data/log/access.log\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暂停1秒")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata02 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pwd")]),s._v("\n/data/log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bigdata03 编写同样脚本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata02 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp -rq generateAccessLog.sh 192.168.35.102:/data/log")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("分别编写配置文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bigdata04 编写脚本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat avro-to-hdfs.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# agent的名称是a1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定source组件、channel组件和Sink组件的名称")]),s._v("\na1.sources "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置source组件")]),s._v("\na1.sources.r1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sources.r1.bind "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\na1.sources.r1.port "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45454")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置channel组件")]),s._v("\na1.channels.c1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置sink组件")]),s._v("\na1.sinks.k1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs\na1.sinks.k1.hdfs.path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs://192.168.35.100:9000/access/%Y%m%d\na1.sinks.k1.hdfs.filePrefix "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" access\na1.sinks.k1.hdfs.fileType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DataStream\na1.sinks.k1.hdfs.writeFormat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Text\na1.sinks.k1.hdfs.rollInterval "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v("\na1.sinks.k1.hdfs.rollSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("134217728")]),s._v("\na1.sinks.k1.hdfs.rollCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\na1.sinks.k1.hdfs.useLocalTimeStamp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把组件连接起来")]),s._v("\na1.sources.r1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k1.channel "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bigdata02 编写脚本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata02 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /data/soft/apache-flume-1.9.0-bin/conf/file-to-avro-101.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# agent的名称是a1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定source组件、channel组件和Sink组件的名称")]),s._v("\na1.sources "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置source组件")]),s._v("\na1.sources.r1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("\na1.sources.r1.command "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-F")]),s._v(" /data/log/access.log\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置channel组件")]),s._v("\na1.channels.c1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置sink组件")]),s._v("\na1.sinks.k1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k1.hostname "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.103\na1.sinks.k1.port "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45454")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把组件连接起来")]),s._v("\na1.sources.r1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k1.channel "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\nYou have new mail "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /var/spool/mail/root\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata02 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bigdata03 编写配置文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata03 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /data/soft/apache-flume-1.9.0-bin/conf/file-to-avro-102.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#agent的名称是a1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定source组件、channel组件和Sink组件的名称")]),s._v("\na1.sources "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置source组件")]),s._v("\na1.sources.r1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("\na1.sources.r1.command "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-F")]),s._v(" /data/log/access.log\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置channel组件")]),s._v("\na1.channels.c1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置sink组件")]),s._v("\na1.sinks.k1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k1.hostname "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".35.103\na1.sinks.k1.port "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45454")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把组件连接起来")]),s._v("\na1.sources.r1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k1.channel "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata03 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看HDFS")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 hadoop-3.2.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bin/hdfs dfs -cat hdfs://192.168.35.100:9000/access/20220825/access.1661409230827.tmp")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v(".tmp结尾代表文件正在被使用，关闭监听后会去除")])])]),s._v(" "),a("li",[a("p",[s._v("启动顺序和关闭顺序")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 bigdata04")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 apache-flume-1.9.0-bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bin/flume-ng agent --name a1 --conf conf --conf-file conf/avro-to-hdfs.conf -Dflume.root.logger=INFO,console")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动bigdata03")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata03 apache-flume-1.9.0-bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bin/flume-ng agent --name a1 --conf conf --conf-file conf/file-to-avro-102.conf -Dflume.root.logger=INFO,console")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bigdata03脚本启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata03 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sh -x generateAccessLog.sh ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动bigdata02")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata02 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bin/flume-ng agent --name a1 --conf conf --conf-file conf/file-to-avro-101.conf -Dflume.root.logger=INFO,console")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bigdata02 脚本启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata02 log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sh -x generateAccessLog.sh")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("blockquote",[a("p",[s._v("注意启动顺序 bigdata04--\x3ebigdata02---\x3ebigdata03")]),s._v(" "),a("p",[s._v("关闭顺序:bigdata02---\x3ebigdata03---\x3ebigdata04")])])])])]),s._v(" "),a("li",[a("p",[s._v("总结")]),s._v(" "),a("ol",[a("li",[s._v("给每个组件起名字")]),s._v(" "),a("li",[s._v("配置每个组件的相关参数")]),s._v(" "),a("li",[s._v("把它们联通起来")])])])]),s._v(" "),a("h2",{attrs:{id:"_6-6-flume高级组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-flume高级组件"}},[s._v("#")]),s._v(" 6.6 Flume高级组件")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("创建监控文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bigdata04 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /data/log/moreType.log ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"14943445328940974601"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"uid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"840717325115457536"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lat"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"53.530598"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lnt"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-2.5620373"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hots"')]),s._v(":0,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"title"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"status"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topicId"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"end_time"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1494344570"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"watch_num"')]),s._v(":0,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"share_num"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"replay_url"')]),s._v(":null,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"replay_num"')]),s._v(":0,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"start_time"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1494344544"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),s._v(":1494344571,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"video_info"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"uid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"861848974414839801"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mick"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"usign"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sex"')]),s._v(":1,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"birthday"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"face"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"big_face"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"email"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"abc@qq.com"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mobile"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reg_type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"102"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"last_login_time"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1494344580"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reg_time"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1494344580"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"last_update_time"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1494344580"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"status"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"is_verified"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"verified_info"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"is_seller"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"level"')]),s._v(":1,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exp"')]),s._v(":0,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"anchor_level"')]),s._v(":0,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"anchor_exp"')]),s._v(":0,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"os"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"android"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),s._v(":1494344580,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user_info"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"send_id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"834688818270961664"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"good_id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"223"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"video_id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"14943443045138661356"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gold"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),s._v(":1494344574,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gift_record"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("Source Interceptors(拦截器配置文件 :file-to-hdfs-moreType.conf)")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# agent的名称是a1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定source组件、channel组件和Sink组件的名称")]),s._v("\na1.sources "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置source组件")]),s._v("\na1.sources.r1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("\na1.sources.r1.command "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-F")]),s._v(" /data/log/moreType.log\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置拦截器 [多个拦截器按照顺序依次执行]")]),s._v("\na1.sources.r1.interceptors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" i1 i2 i3 i4\na1.sources.r1.interceptors.i1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" search_replace\na1.sources.r1.interceptors.i1.searchPattern "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"video_info"')]),s._v("\na1.sources.r1.interceptors.i1.replaceString "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"videoInfo"')]),s._v("\n\na1.sources.r1.interceptors.i2.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" search_replace\na1.sources.r1.interceptors.i2.searchPattern "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user_info"')]),s._v("\na1.sources.r1.interceptors.i2.replaceString "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userInfo"')]),s._v("\n\na1.sources.r1.interceptors.i3.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" search_replace\na1.sources.r1.interceptors.i3.searchPattern "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gift_record"')]),s._v("\na1.sources.r1.interceptors.i3.replaceString "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"giftRecord"')]),s._v("\n\n\na1.sources.r1.interceptors.i4.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" regex_extractor\na1.sources.r1.interceptors.i4.regex "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"('),a("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[s._v("\\\\")]),s._v('w+)"')]),s._v("\na1.sources.r1.interceptors.i4.serializers "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" s1\na1.sources.r1.interceptors.i4.serializers.s1.name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logType\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置channel组件")]),s._v("\na1.channels.c1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\na1.channels.c1.checkpointDir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/soft/apache-flume-1.9.0-bin/data/moreType/checkpoint\na1.channels.c1.dataDirs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/soft/apache-flume-1.9.0-bin/data/moreType/data\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置sink组件")]),s._v("\na1.sinks.k1.type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs\na1.sinks.k1.hdfs.path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs://192.168.35.100:9000/moreType/%Y%m%d/%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("logType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\na1.sinks.k1.hdfs.fileType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DataStream\na1.sinks.k1.hdfs.writeFormat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Text\na1.sinks.k1.hdfs.rollInterval "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v("\na1.sinks.k1.hdfs.rollSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("134217728")]),s._v("\na1.sinks.k1.hdfs.rollCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\na1.sinks.k1.hdfs.useLocalTimeStamp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#增加文件前缀和后缀")]),s._v("\na1.sinks.k1.hdfs.filePrefix "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" data\na1.sinks.k1.hdfs.fileSuffix "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .log\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把组件连接起来")]),s._v("\na1.sources.r1.channels "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k1.channel "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("Channel Selectors")]),s._v(" "),a("ol",[a("li",[s._v("多Channel之Replicating Channel Selector")]),s._v(" "),a("li",[s._v("多Channel之Multiplexing Channel Selector")])])]),s._v(" "),a("li",[a("p",[s._v("Sink Processors")]),s._v(" "),a("ol",[a("li",[s._v("负载均衡")]),s._v(" "),a("li",[s._v("故障转移")])])])]),s._v(" "),a("h2",{attrs:{id:"_6-7-flume-进阶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-7-flume-进阶"}},[s._v("#")]),s._v(" 6.7 Flume 进阶")]),s._v(" "),a("ul",[a("li",[s._v("自定义组件")]),s._v(" "),a("li",[s._v("Flume 优化\n"),a("ol",[a("li",[s._v("调整Flume进程的内存大小")]),s._v(" "),a("li",[s._v("在一台服务器启动多个agent的时候，建议修改配置区分日志文件")])])])])])}),[],!1,null,null,null);a.default=e.exports}}]);